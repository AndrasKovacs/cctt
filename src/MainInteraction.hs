
module MainInteraction where

import System.Environment
import System.Exit

import Common
import CoreTypes
import Elaboration
import Parser
import Pretty

-- | Elaborate a string, render output.
elabString :: String -> IO ()
elabString str = do
  top <- parseString "(interactive)" str
  top <- elabTop Nothing "(interactive)" str top
  putStrLn $ pretty top

helpMsg = unlines [
   "usage: cctt <file> [nf <topdef>] [elab] [verbose]"
  ,""
  ,"Checks <file>. Options:"
  ,"  nf <topdef>   prints the normal form of top-level definition <topdef>"
  ,"  elab          prints the elaboration output"
  ,"  verbose       prints path endpoints and hcom types explicitly"
  ]

elabFile :: FilePath -> [String] -> IO ()
elabFile path args = mainWith (pure $ path : args)

mainInteraction :: IO ()
mainInteraction = mainWith getArgs

parseArgs :: [String] -> IO (FilePath, Maybe Name, Bool, Bool)
parseArgs args = do
  let exit = putStrLn helpMsg >> exitSuccess
  (path, args) <- case args of
    path:args -> pure (path, args)
    _         -> exit
  (printnf, args) <- case args of
    "nf":printnf:args -> pure (Just printnf, args)
    args              -> pure (Nothing, args)
  (elab, args) <- case args of
    "elab":args -> pure (True, args)
    args        -> pure (False, args)
  verbose <- case args of
    "verbose":[] -> pure True
    []           -> pure False
    _            -> exit
  pure (path, printnf, elab, verbose)

mainWith :: IO [String] -> IO ()
mainWith getArgs = do
  setVerbosity False
  (path, printnf, printelab, verbose) <- parseArgs =<< getArgs
  when verbose $ setVerbosity True
  file <- readFile path
  (top, tparse) <- timed (parseString path file)
  putStrLn (path ++ " parsed in " ++ show tparse)
  (top, tcheck) <- timed (elabTop printnf path file top)
  putStrLn (path ++ " checked in " ++ show tcheck)
  putStrLn ("checked " ++ show (topLen top) ++ " definitions")
  putStrLn ("total time: " ++ show (tparse + tcheck))
  when printelab do
    putStrLn ""
    putStrLn $ pretty top
  pure ()
str1 :: String
str1 = "λ x. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x))), λ x. hcom 1 0 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (j. B) x))), λ x {x} {hcom 1 0 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (j. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))))} j. hcom 0 1 A [j = 0 k. x; j = 1 k. hcom 1 0 A [k = 0 i. f.2.2.1 x {x} {f.2.1 (f.1 x)} i] (f.2.1 (hcom k 0 B [] (coe k 0 (l. B) (hcom 1 0 B [0 = k i. f.1 x; k = 0 j1. f.1 x; k = 1 j1. hcom 1 0 B [j1 = 0 i. hcom 1 i B [] (hcom 0 1 B [] (coe 0 1 (l. B) (f.1 x))); j1 = 1 i. hcom 0 1 B [] (coe 0 1 (l. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l. B) (f.1 x)))] (hcom 0 k B [] (coe 0 k (l. B) (f.1 x)))))))] x, λ x {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 (hcom 1 0 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (j. B) x)))))))} {x} j. hcom 1 0 B [j = 0 k. hcom 1 0 B [k = 1 i. x] (hcom k 1 B [] (coe k 1 (l. B) (hcom 1 0 B [1 = k i. x; k = 0 j1. hcom 1 0 B [j1 = 0 i. f.1 (hcom 1 i A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) x)))); j1 = 1 i. hcom 1 0 B [] (coe 1 0 (l. B) x)] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) x)) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) x)))} {hcom 1 0 B [] (coe 1 0 (l. B) x)} j1); k = 1 j1. x] (hcom 1 k B [] (coe 1 k (l. B) x))))); j = 1 k. x] x, λ x {λ {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} _. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} {λ {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 (hcom 1 0 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (j. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))))))))} {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} j. hcom 1 0 B [j = 0 k. hcom 1 0 B [k = 1 i. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.1 x)))] (hcom k 1 B [] (coe k 1 (l. B) (hcom 1 0 B [1 = k i. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.1 x))); k = 0 j1. hcom 1 0 B [j1 = 0 i. f.1 (hcom 1 i A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.1 x)))))))); j1 = 1 i. hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))} j1); k = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))] (hcom 1 k B [] (coe 1 k (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x))))))))); j = 1 k. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))] (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x))))} l {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 (hcom 0 1 A [l = 0 k. x; l = 1 k. hcom 1 0 A [k = 0 i. f.2.2.1 x {x} {f.2.1 (f.1 x)} i] (f.2.1 (hcom k 0 B [] (coe k 0 (l1. B) (hcom 1 0 B [0 = k i. f.1 x; k = 0 j. f.1 x; k = 1 j. hcom 1 0 B [j = 0 i. hcom 1 i B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j = 1 i. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k B [] (coe 0 k (l1. B) (f.1 x)))))))] x))))} {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} k. hcom 0 1 B [k = 0 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j. f.1 x; k1 = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x))))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x)))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x)))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i1. f.2.2.1 x {x} {f.2.1 (f.1 x)} i1] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x))))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 (hcom 0 i A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i1. f.2.2.1 x {x} {f.2.1 (f.1 x)} i1] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j. f.1 x; k1 = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x))))))); k = 1 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x)))))); l = 0 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x)))))); l = 1 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [k = 0 k1. hcom 1 0 B [k1 = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))); k1 = 0 j. hcom 1 0 B [j = 0 i2. f.1 (hcom 1 i2 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))); j = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))} j); k1 = 1 j. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))))))))); k = 1 k1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom i 0 B [k = 0 k1. hcom 1 0 B [k1 = i i1. hcom 1 0 B [0 = i i2. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x))); i = 0 j. hcom 1 0 B [j = 0 i1. f.1 (hcom 1 i1 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))); j = 1 i1. hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x))))); k1 = 0 i1. f.2.2.2.2 x {λ {f.1 x} {f.1 x} _. f.1 x} {f.2.2.2.1 (f.1 x)} i1 {f.1 (f.2.2.1 x {x} {f.2.1 (f.1 x)} i1)} {f.1 x} j] (f.2.2.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))) {f.1 (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))} {hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))} j); i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [k1 = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); k1 = 0 j1. hcom 1 0 B [j1 = 0 i2. f.1 (hcom 1 i2 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))} j1); k1 = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))))))))); j = 1 i1. hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); k1 = 0 j1. hcom 1 0 B [j1 = 0 i2. f.1 (hcom 1 i2 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))} j1); k1 = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))); k1 = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); k1 = 0 j1. hcom 1 0 B [j1 = 0 i1. f.1 (hcom 1 i1 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))); j1 = 1 i1. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))} j1); k1 = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))))] (hcom k1 i B [] (coe k1 i (l1. B) (hcom 1 0 B [i = k1 i1. hcom 1 0 B [0 = i i2. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x))); k1 = 0 j. hcom 1 0 B [j = 0 i1. f.1 (hcom 1 i1 A [i = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i2. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))))); j = 1 i1. hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i2. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x))))); i = 0 i1. f.2.2.2.2 x {λ {f.1 x} {f.1 x} _. f.1 x} {f.2.2.2.1 (f.1 x)} i1 {f.1 (f.2.2.1 x {x} {f.2.1 (f.1 x)} i1)} {f.1 x} j] (f.2.2.2.1 (hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))) {f.1 (f.2.1 (hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))))} {hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))} j); k1 = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [i = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [0 = i i2. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))); j = 1 i1. hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [0 = i i2. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x))))); i = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x))))))] (hcom i k1 B [] (coe i k1 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x))))))))); k = 1 k1. hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x))); i = 0 i1. f.1 (hcom 0 i1 A [k = 0 k1. hcom 1 0 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j. f.1 x; k1 = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x))))))); k = 1 k1. x] x); i = 1 i1. hcom 1 i1 B [k = 0 k1. hcom 1 0 B [k1 = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))); k1 = 0 j. hcom 1 0 B [j = 0 i2. f.1 (hcom 1 i2 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))); j = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))} j); k1 = 1 j. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))))))))); k = 1 k1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))))] (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x)))))))] (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x))))"

str2 :: String
str2 = "λ x. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x))), λ x. hcom 1 0 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (j. B) x))), λ x {x} {hcom 1 0 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (j. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))))} j. hcom 0 1 A [j = 0 k. x; j = 1 k. hcom 1 0 A [k = 0 i. f.2.2.1 x {x} {f.2.1 (f.1 x)} i] (f.2.1 (hcom k 0 B [] (coe k 0 (l. B) (hcom 1 0 B [0 = k i. f.1 x; k = 0 j1. f.1 x; k = 1 j1. hcom 1 0 B [j1 = 0 i. hcom 1 i B [] (hcom 0 1 B [] (coe 0 1 (l. B) (f.1 x))); j1 = 1 i. hcom 0 1 B [] (coe 0 1 (l. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l. B) (f.1 x)))] (hcom 0 k B [] (coe 0 k (l. B) (f.1 x)))))))] x, λ x {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 (hcom 1 0 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (j. B) x)))))))} {x} j. hcom 1 0 B [j = 0 k. hcom 1 0 B [k = 1 i. x] (hcom k 1 B [] (coe k 1 (l. B) (hcom 1 0 B [1 = k i. x; k = 0 j1. hcom 1 0 B [j1 = 0 i. f.1 (hcom 1 i A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) x)))); j1 = 1 i. hcom 1 0 B [] (coe 1 0 (l. B) x)] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) x)) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) x)))} {hcom 1 0 B [] (coe 1 0 (l. B) x)} j1); k = 1 j1. x] (hcom 1 k B [] (coe 1 k (l. B) x))))); j = 1 k. x] x, λ x {λ {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} _. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} {λ {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 (hcom 1 0 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (j. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))))))))} {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} j. hcom 1 0 B [j = 0 k. hcom 1 0 B [k = 1 i. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.1 x)))] (hcom k 1 B [] (coe k 1 (l. B) (hcom 1 0 B [1 = k i. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.1 x))); k = 0 j1. hcom 1 0 B [j1 = 0 i. f.1 (hcom 1 i A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.1 x)))))))); j1 = 1 i. hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))))} j1); k = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))] (hcom 1 k B [] (coe 1 k (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x))))))))); j = 1 k. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))] (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x))))} l {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 (hcom 0 1 A [l = 0 k. x; l = 1 k. hcom 1 0 A [k = 0 i. f.2.2.1 x {x} {f.2.1 (f.1 x)} i] (f.2.1 (hcom k 0 B [] (coe k 0 (l1. B) (hcom 1 0 B [0 = k i. f.1 x; k = 0 j. f.1 x; k = 1 j. hcom 1 0 B [j = 0 i. hcom 1 i B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j = 1 i. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k B [] (coe 0 k (l1. B) (f.1 x)))))))] x))))} {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x)))} k. hcom 0 1 B [k = 0 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j. f.1 x; k1 = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x))))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x)))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x)))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i1. f.2.2.1 x {x} {f.2.1 (f.1 x)} i1] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x))))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 (hcom 0 i A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i1. f.2.2.1 x {x} {f.2.1 (f.1 x)} i1] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j. f.1 x; k1 = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))] x))))))); k = 1 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x)))))); l = 0 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x)))))); l = 1 i. hcom 1 0 B [i = 1 i1. hcom i 0 B [k = 0 k1. hcom 1 0 B [k1 = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))); k1 = 0 j. hcom 1 0 B [j = 0 i2. f.1 (hcom 1 i2 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))); j = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))} j); k1 = 1 j. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))))))))); k = 1 k1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom i 0 B [k = 0 k1. hcom 1 0 B [k1 = i i1. hcom 1 0 B [0 = i i2. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x))); i = 0 j. hcom 1 0 B [j = 0 i1. f.1 (hcom 1 i1 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))); j = 1 i1. hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x))))); k1 = 0 i1. f.2.2.2.2 x {λ {f.1 x} {f.1 x} _. f.1 x} {f.2.2.2.1 (f.1 x)} i1 {f.1 (f.2.2.1 x {x} {f.2.1 (f.1 x)} i1)} {f.1 x} j] (f.2.2.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))) {f.1 (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))))} {hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.1 x; k1 = 0 j1. f.1 x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x)))))} j); i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [k1 = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); k1 = 0 j1. hcom 1 0 B [j1 = 0 i2. f.1 (hcom 1 i2 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))} j1); k1 = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))))))))); j = 1 i1. hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); k1 = 0 j1. hcom 1 0 B [j1 = 0 i2. f.1 (hcom 1 i2 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))} j1); k1 = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))); k1 = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); k1 = 0 j1. hcom 1 0 B [j1 = 0 i1. f.1 (hcom 1 i1 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))); j1 = 1 i1. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))))} j1); k1 = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))))] (hcom k1 i B [] (coe k1 i (l1. B) (hcom 1 0 B [i = k1 i1. hcom 1 0 B [0 = i i2. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x))); k1 = 0 j. hcom 1 0 B [j = 0 i1. f.1 (hcom 1 i1 A [i = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i2. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))))); j = 1 i1. hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i2. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x))))); i = 0 i1. f.2.2.2.2 x {λ {f.1 x} {f.1 x} _. f.1 x} {f.2.2.2.1 (f.1 x)} i1 {f.1 (f.2.2.1 x {x} {f.2.1 (f.1 x)} i1)} {f.1 x} j] (f.2.2.2.1 (hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))) {f.1 (f.2.1 (hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))))} {hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))} j); k1 = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [i = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [0 = i i2. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x)))))); j = 1 i1. hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [0 = i i2. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x))))); i = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j1. f.1 x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.1 x))))))] (hcom i k1 B [] (coe i k1 (l1. B) (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x))))))))); k = 1 k1. hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x))); i = 0 i1. f.1 (hcom i i1 A [k = 0 k1. hcom 1 0 A [k1 = 0 i2. f.2.2.1 x {x} {f.2.1 (f.1 x)} i2] (f.2.1 (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.1 x; k1 = 0 j. f.1 x; k1 = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.1 x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.1 x))))))); k = 1 k1. x] x); i = 1 i1. hcom i i1 B [k = 0 k1. hcom 1 0 B [k1 = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))); k1 = 0 j. hcom 1 0 B [j = 0 i2. f.1 (hcom 1 i2 A [] (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))); j = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))] (f.2.2.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))) {f.1 (f.2.1 (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))))} j); k1 = 1 j. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))))))))); k = 1 k1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x)))] (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.1 x))))] (hcom 1 0 B [0 = i i1. f.1 x; i = 0 j. f.1 x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.1 x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.1 x)))))))] (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.1 x))))"
