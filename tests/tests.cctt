{-

isLogEq (A B : U)(f : A → B) : U := (B → A);

isSection (A B : U)(f : A → B) : U := (g : B → A) × ((x : A) → x = g (f x));

isRetraction (A B : U)(f : A → B) : U := (g : B → A) × ((x : B) → f (g x) = x);

isIso (A B : U)(f : A → B) : U :=
    (g    : B → A)
  × (linv : (x : A) → x = g (f x))
  × ((x : B) → f (g x) = x);

isEquiv (A B : U)(f : A → B) : U :=
    (g    : B → A)
  × (linv : (x : A) → x = g (f x))
  × (rinv : (x : B) → f (g x) = x)
  × ((x : A) → refl ={i. f (linv x i) = f x} (rinv (f x)));

equiv (A B : U) : U :=
  (f : A → B) × isEquiv A B f;

idEquiv (A : U) : equiv A A :=
  (λ x. x, λ x. x, λ x _. x, λ x _. x, λ x _ _. x);

coe01isEquiv (P : I → U) : isEquiv (P 0) (P 1) (λ x. coe 0 1 P x) :=
  let f' (i : I)(x : P 0)           : P i := coe 0 i P x;
  let g' (i : I)(x : P i)           : P 0 := coe i 0 P x;
  let linv' (i : I)(x : P 0)(j : I) : P 0 := hcom 0 i (P 0) [j=0 k. x; j=1 k. coe k 0 P (coe 0 k P x)] x;
  let rinv' (i : I)(x : P i)(j : I) : P i := hcom i 0 (P i) [j=0 k. coe k i P (coe i k P x); j=1 k. x] x;

  ( λ x. g' 1 x
  , λ x j. linv' 1 x j
  , λ x j. rinv' 1 x j
  , λ x l k. hcom 0 1 (P 1) [k=0 i. coe i 1 P (f' i (linv' i x l))
                            ;k=1 i. coe i 1 P (f' i x)
		            ;l=0 i. coe i 1 P (f' i x)
		            ;l=1 i. coe i 1 P (rinv' i (f' i x) k)]
		            (coe 0 1 P x)
  );

-- try to print a bigger coe glue

-- foo (i : I)(A : U)(x : Glue A [i=0. (A, idEquiv A)]) : Glue A [i=0. (A, idEquiv A)] :=
--   glue (hcom 0 1 A [i = 0 i1. hcom 0 i1 A [] x] (unglue x)) [i = 0. A, λ x1. x1,
--   λ x1. x1, λ x1 {x1} {x1} _. x1, λ x1 {x1} {x1} _. x1, λ x1 {λ {x1} {x1} _. x1}
--   {λ {x1} {x1} _. x1} _ {x1} {x1} _. x1] [i = 0. hcom 0 1 A [] x];
--   -- hcom 0 1 (Glue A [i=0. (A, idEquiv A)]) [] x;

-- also a bigger hcom glue

breh (A : U)(x : A) : Glue A [] := glue (hcom 1 0 A [] (hcom 0 1 A [] (coe 0 1 (i. A) x))) [];


-- foo (A : U) : isRetraction A (Glue A []) (breh A) :=

--   λ x. hcom 1 0 A [] (hcom 1 0 A [] (coe 1 0 (i. A) (unglue x)))

-- , λ x {glue (hcom 1 0 A [] (hcom 0 1 A [] (coe 0 1 (i. A) (hcom 1 0 A [] (hcom 1 0 A [] (coe 1 0 (i. A) (unglue x))))))) [] []}
--       {x}
--       j.

--       glue (
--         hcom 1 0 A [j = 0 k.

-- unglue (glue (hcom 1 0 A [k = 1 i. unglue (glue (unglue x)
-- [] [])] (hcom k 1 A [] (coe k 1 (i. A) (unglue (glue (hcom 1 0 A [1 = k
-- i. unglue x ; k = 0 i. hcom 1 0 A [i = 0 i1. hcom 1 i1 A [] (hcom 1 0 A [] (coe
-- 1 0 (i2. A) (unglue x))); i = 1 i1. hcom 1 0 A [] (coe 1 0 (i2. A) (unglue x))]
-- (hcom 1 0 A [] (coe 1 0 (i1. A) (unglue x)))] (hcom 1 k A [] (coe 1 k (i. A)
-- (unglue x)))) [k = 0. A, λ x1. x1, λ x1. x1, λ x1 {x1} {x1} _. x1, λ x1 {x1}
-- {x1} _. x1, λ x1 {λ {x1} {x1} _. x1} {λ {x1} {x1} _. x1} _ {x1} {x1} _. x1] [k =
-- 0. hcom 1 0 A [] (hcom 1 0 A [] (coe 1 0 (i. A) (unglue x)))]))))) [] [])

--                  ; j = 1 k. unglue x]
--                    (unglue x))
--         []
-- 	[];

  -- let P (i : I) : U := Glue A [i=0.(A,idEquiv A)];
  -- ( λ x. coe 1 0 P x
  -- , λ x j. hcom 1 0 (P 1) [j=0 k. coe k 1 P (coe 1 k P x); j=1 k. x] x
  -- );


-- foo (A : U)(a : A) : A :=
--   coe 1 0 (i. Glue A [0=i.(A, λ x. x, λ x. x, λ x _. x, λ x _. x, λ x _ _.x)]) (glue a []);

-- -- massive nf
-- bar (x : U)(l : I) : U :=
--   -- hcom 0 1 U [l = 0 i. Glue x [0=i. (x, λ x. x, λ x. x, λ x _. x, λ x _. x, λ x _ _.x)]] x;
-- Glue x [l = 0. Glue x [], λ x1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i. x) (unglue x1))), λ x1. glue (hcom 1 0 x [] (hcom 0 1 x [] (coe 0 1 (i. x)
-- x1))) [] [], λ x1 {x1} {glue (hcom 1 0 x [] (hcom 0 1 x [] (coe 0 1 (i. x) (hcom
-- 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1))))))) [] []} j. glue (hcom 1
-- 0 x [j = 0 k. unglue x1; j = 1 k. unglue (glue (hcom 1 0 x [k = 1 i. unglue x1]
-- (hcom k 1 x [] (coe k 1 (i. x) (hcom 1 0 x [1 = k i. unglue x1; 0 = k i. hcom 1
-- 0 x [i = 0 i1. hcom 1 i1 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1))); i =
-- 1 i1. hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0
-- (i1. x) (unglue x1)))] (hcom 1 k x [] (coe 1 k (i. x) (unglue x1))))))) [] [])]
-- (unglue x1)) [] [], λ x1 {hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (hcom 1 0
-- x [] (hcom 0 1 x [] (coe 0 1 (i. x) x1)))))} {x1} j. hcom 0 1 x [j = 0 k. hcom 1
-- 0 x [k = 0 i. x1] (hcom k 0 x [] (coe k 0 (i. x) (hcom 1 0 x [0 = k i. x1; 0 = k
-- i. x1] (hcom 0 k x [] (coe 0 k (i. x) x1))))); j = 1 k. x1] x1, λ x1 {λ {hcom 1
-- 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1)))} {hcom 1 0 x [] (hcom 1 0 x
-- [] (coe 1 0 (i. x) (unglue x1)))} _. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i. x) (unglue x1)))} {λ {hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (hcom 1 0
-- x [] (hcom 0 1 x [] (coe 0 1 (i. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i. x) (unglue x1)))))))))} {hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x)
-- (unglue x1)))} k. hcom 0 1 x [k = 0 k1. hcom 1 0 x [k1 = 0 i. hcom 1 0 x []
-- (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0 (i. x)
-- (hcom 1 0 x [0 = k1 i. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue
-- x1))); 0 = k1 i. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))]
-- (hcom 0 k1 x [] (coe 0 k1 (i. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x)
-- (unglue x1))))))))); k = 1 k1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x)
-- (unglue x1)))] (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1))))} l1
-- {hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (hcom 1 0 x [l1 = 0 k. unglue x1;
-- l1 = 1 k. unglue (glue (hcom 1 0 x [k = 1 i. unglue x1] (hcom k 1 x [] (coe k 1
-- (i. x) (hcom 1 0 x [1 = k i. unglue x1; 0 = k i. hcom 1 0 x [i = 0 i1. hcom 1 i1
-- x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1))); i = 1 i1. hcom 1 0 x [] (coe
-- 1 0 (i2. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))] (hcom 1
-- k x [] (coe 1 k (i. x) (unglue x1))))))) [] [])] (unglue x1))))} {hcom 1 0 x []
-- (hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1)))} k. hcom 1 0 x [k = 0 i. hcom 1 0 x
-- [i = 0 i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (hcom 1 0 x [l1 = 0
-- k1. unglue x1; l1 = 1 k1. unglue (glue (hcom 1 0 x [k1 = 1 i2. unglue x1] (hcom
-- k1 1 x [] (coe k1 1 (i2. x) (hcom 1 0 x [1 = k1 i2. unglue x1; 0 = k1 i2. hcom 1
-- 0 x [i2 = 0 i3. hcom 1 i3 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); i2
-- = 1 i3. hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0
-- (i3. x) (unglue x1)))] (hcom 1 k1 x [] (coe 1 k1 (i2. x) (unglue x1))))))) []
-- [])] (unglue x1))))] (hcom i 0 x [] (coe i 0 (i1. x) (hcom 1 0 x [1 = i
-- i1. unglue x1; 0 = i i1. hcom 1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x []
-- (coe 1 0 (i3. x) (hcom 1 0 x [l1 = 0 k1. unglue x1; l1 = 1 k1. unglue (glue
-- (hcom 1 0 x [k1 = 1 i3. unglue x1] (hcom k1 1 x [] (coe k1 1 (i3. x) (hcom 1 0 x
-- [1 = k1 i3. unglue x1; 0 = k1 i3. hcom 1 0 x [i3 = 0 i4. hcom 1 i4 x [] (hcom 1
-- 0 x [] (coe 1 0 (i5. x) (unglue x1))); i3 = 1 i4. hcom 1 0 x [] (coe 1 0 (i5. x)
-- (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 1 k1 x []
-- (coe 1 k1 (i3. x) (unglue x1))))))) [] [])] (unglue x1)))); i1 = 1 i2. hcom 1 0
-- x [] (coe 1 0 (i3. x) (hcom 1 0 x [l1 = 0 k1. unglue x1; l1 = 1 k1. unglue (glue
-- (hcom 1 0 x [k1 = 1 i3. unglue x1] (hcom k1 1 x [] (coe k1 1 (i3. x) (hcom 1 0 x
-- [1 = k1 i3. unglue x1; 0 = k1 i3. hcom 1 0 x [i3 = 0 i4. hcom 1 i4 x [] (hcom 1
-- 0 x [] (coe 1 0 (i5. x) (unglue x1))); i3 = 1 i4. hcom 1 0 x [] (coe 1 0 (i5. x)
-- (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 1 k1 x []
-- (coe 1 k1 (i3. x) (unglue x1))))))) [] [])] (unglue x1)))] (hcom 1 0 x [] (coe 1
-- 0 (i2. x) (hcom 1 0 x [l1 = 0 k1. unglue x1; l1 = 1 k1. unglue (glue (hcom 1 0 x
-- [k1 = 1 i2. unglue x1] (hcom k1 1 x [] (coe k1 1 (i2. x) (hcom 1 0 x [1 = k1
-- i2. unglue x1; 0 = k1 i2. hcom 1 0 x [i2 = 0 i3. hcom 1 i3 x [] (hcom 1 0 x []
-- (coe 1 0 (i4. x) (unglue x1))); i2 = 1 i3. hcom 1 0 x [] (coe 1 0 (i4. x)
-- (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom 1 k1 x []
-- (coe 1 k1 (i2. x) (unglue x1))))))) [] [])] (unglue x1))))] (hcom 1 i x [] (coe
-- 1 i (i1. x) (hcom 1 i x [l1 = 0 k1. unglue x1; l1 = 1 k1. unglue (glue (hcom 1 0
-- x [k1 = 1 i1. unglue x1] (hcom k1 1 x [] (coe k1 1 (i1. x) (hcom 1 0 x [1 = k1
-- i1. unglue x1; 0 = k1 i1. hcom 1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x []
-- (coe 1 0 (i3. x) (unglue x1))); i1 = 1 i2. hcom 1 0 x [] (coe 1 0 (i3. x)
-- (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom 1 k1 x []
-- (coe 1 k1 (i1. x) (unglue x1))))))) [] [])] (unglue x1))))))); k = 1 i. hcom 1 0
-- x [i = 0 i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom
-- i 0 x [] (coe i 0 (i1. x) (hcom 1 0 x [1 = i i1. unglue x1; 0 = i i1. hcom 1 0 x
-- [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))); i1 = 1
-- i2. hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i2. x)
-- (unglue x1)))] (hcom 1 i x [] (coe 1 i (i1. x) (unglue x1)))))); l1 = 0 i. hcom
-- 1 0 x [i = 0 i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))]
-- (hcom i 0 x [] (coe i 0 (i1. x) (hcom 1 0 x [1 = i i1. unglue x1; 0 = i i1. hcom
-- 1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)));
-- i1 = 1 i2. hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0
-- (i2. x) (unglue x1)))] (hcom 1 i x [] (coe 1 i (i1. x) (unglue x1)))))); l1 = 1
-- i. hcom 1 0 x [i = 0 i1. hcom 0 1 x [k = 0 k1. hcom 1 0 x [k1 = 0 i2. hcom 1 0 x
-- [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0
-- (i2. x) (hcom 1 0 x [0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x)
-- (unglue x1))); 0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue
-- x1)))] (hcom 0 k1 x [] (coe 0 k1 (i2. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i2. x) (unglue x1))))))))); k = 1 k1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i2. x) (unglue x1)))] (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue
-- x1))))] (hcom i 0 x [] (coe i 0 (i1. x) (hcom i 1 x [k = 0 k1. unglue (glue
-- (hcom 1 0 x [k1 = i i1. hcom 1 0 x [1 = i i2. unglue x1; 0 = i i2. hcom 1 0 x
-- [i2 = 0 i3. hcom 1 i3 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); i2 = 1
-- i3. hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i3. x)
-- (unglue x1)))] (hcom 1 i x [] (coe 1 i (i2. x) (unglue x1))); 0 = i i1. hcom 1 0
-- x [i1 = 0 i2. hcom 1 i2 x [k1 = 0 i3. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i4. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0 (i3. x) (hcom 1 0 x [0 = k1
-- i3. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); 0 = k1 i3. hcom
-- 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 0 k1 x [] (coe 0
-- k1 (i3. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))))))));
-- i1 = 1 i2. hcom k1 0 x [] (coe k1 0 (i3. x) (hcom 1 0 x [0 = k1 i3. hcom 1 0 x
-- [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); 0 = k1 i3. hcom 1 0 x [] (hcom
-- 1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 0 k1 x [] (coe 0 k1 (i3. x) (hcom
-- 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))))))); k1 = 0 i2. hcom 1 0
-- x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0
-- (i2. x) (hcom 1 0 x [0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x)
-- (unglue x1))); 0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue
-- x1)))] (hcom 0 k1 x [] (coe 0 k1 (i2. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i2. x) (unglue x1)))))))))] (hcom k1 i x [] (coe k1 i (i1. x) (hcom 1 0 x [i =
-- k1 i1. hcom 1 0 x [1 = i i2. unglue x1; 0 = i i2. hcom 1 0 x [i2 = 0 i3. hcom 1
-- i3 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); i2 = 1 i3. hcom 1 0 x []
-- (coe 1 0 (i4. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))]
-- (hcom 1 i x [] (coe 1 i (i2. x) (unglue x1))); 0 = k1 i1. hcom 1 0 x [i1 = 0
-- i2. hcom 1 i2 x [i = 0 i3. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue
-- x1)))] (hcom i 0 x [] (coe i 0 (i3. x) (hcom 1 0 x [1 = i i3. unglue x1; 0 = i
-- i3. hcom 1 0 x [i3 = 0 i4. hcom 1 i4 x [] (hcom 1 0 x [] (coe 1 0 (i5. x)
-- (unglue x1))); i3 = 1 i4. hcom 1 0 x [] (coe 1 0 (i5. x) (unglue x1))] (hcom 1 0
-- x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 1 i x [] (coe 1 i (i3. x) (unglue
-- x1)))))); i1 = 1 i2. hcom i 0 x [] (coe i 0 (i3. x) (hcom 1 0 x [1 = i
-- i3. unglue x1; 0 = i i3. hcom 1 0 x [i3 = 0 i4. hcom 1 i4 x [] (hcom 1 0 x []
-- (coe 1 0 (i5. x) (unglue x1))); i3 = 1 i4. hcom 1 0 x [] (coe 1 0 (i5. x)
-- (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 1 i x [] (coe
-- 1 i (i3. x) (unglue x1))))); i = 0 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i3. x) (unglue x1)))] (hcom i 0 x [] (coe i 0 (i2. x) (hcom 1 0 x [1 = i
-- i2. unglue x1; 0 = i i2. hcom 1 0 x [i2 = 0 i3. hcom 1 i3 x [] (hcom 1 0 x []
-- (coe 1 0 (i4. x) (unglue x1))); i2 = 1 i3. hcom 1 0 x [] (coe 1 0 (i4. x)
-- (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom 1 i x [] (coe
-- 1 i (i2. x) (unglue x1))))))] (hcom i k1 x [] (coe i k1 (i1. x) (hcom 1 0 x [1 =
-- i i1. unglue x1; 0 = i i1. hcom 1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x []
-- (coe 1 0 (i3. x) (unglue x1))); i1 = 1 i2. hcom 1 0 x [] (coe 1 0 (i3. x)
-- (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom 1 i x [] (coe
-- 1 i (i1. x) (unglue x1)))))))))) [0 = i. x, λ x2. x2, λ x2. x2, λ x2 {x2} {x2}
-- _. x2, λ x2 {x2} {x2} _. x2, λ x2 {λ {x2} {x2} _. x2} {λ {x2} {x2} _. x2} _ {x2}
-- {x2} _. x2] [0 = i. hcom 1 0 x [k1 = 0 i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i2. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0 (i1. x) (hcom 1 0 x [0 = k1
-- i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1))); 0 = k1 i1. hcom
-- 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom 0 k1 x [] (coe 0
-- k1 (i1. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))))))))]);
-- k = 1 k1. unglue (glue (hcom 1 0 x [1 = i i1. unglue x1; 0 = i i1. hcom 1 0 x
-- [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))); i1 = 1
-- i2. hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i2. x)
-- (unglue x1)))] (hcom 1 i x [] (coe 1 i (i1. x) (unglue x1)))) [0 = i. x, λ
-- x2. x2, λ x2. x2, λ x2 {x2} {x2} _. x2, λ x2 {x2} {x2} _. x2, λ x2 {λ {x2} {x2}
-- _. x2} {λ {x2} {x2} _. x2} _ {x2} {x2} _. x2] [0 = i. hcom 1 0 x [] (hcom 1 0 x
-- [] (coe 1 0 (i1. x) (unglue x1)))]); 0 = i i1. hcom 0 i1 x [k = 0 k1. hcom 1 0 x
-- [k1 = 0 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom
-- k1 0 x [] (coe k1 0 (i2. x) (hcom 1 0 x [0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x []
-- (coe 1 0 (i3. x) (unglue x1))); 0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i3. x) (unglue x1)))] (hcom 0 k1 x [] (coe 0 k1 (i2. x) (hcom 1 0 x [] (hcom 1
-- 0 x [] (coe 1 0 (i2. x) (unglue x1))))))))); k = 1 k1. hcom 1 0 x [] (hcom 1 0 x
-- [] (coe 1 0 (i2. x) (unglue x1)))] (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
-- (i2. x) (unglue x1))))] (unglue (glue (hcom 1 0 x [1 = i i1. unglue x1; 0 = i
-- i1. hcom 1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x [] (coe 1 0 (i3. x)
-- (unglue x1))); i1 = 1 i2. hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))] (hcom 1 0
-- x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom 1 i x [] (coe 1 i (i1. x) (unglue
-- x1)))) [0 = i. x, λ x2. x2, λ x2. x2, λ x2 {x2} {x2} _. x2, λ x2 {x2} {x2}
-- _. x2, λ x2 {λ {x2} {x2} _. x2} {λ {x2} {x2} _. x2} _ {x2} {x2} _. x2] [0 =
-- i. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))])))))] (hcom 1 0
-- x [] (hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1))))];

-}

isLogEq (A B : U)(f : A → B) : U := (B → A);

isSection (A B : U)(f : A → B) : U := (g : B → A) × ((x : A) → x = g (f x));

isRetraction (A B : U)(f : A → B) : U := (g : B → A) × ((x : B) → f (g x) = x);

isIso (A B : U)(f : A → B) : U :=
    (g    : B → A)
  × (linv : (x : A) → x = g (f x))
  × ((x : B) → f (g x) = x);

isCoherent (A B : U)(f : A → B)(g : B → A)(linv : (x : A) → x = g (f x))(rinv : (x : B) → f (g x) = x) : U :=
  (x : A) → refl ={i. f (linv x i) = f x} (rinv (f x));

isEquiv (A B : U)(f : A → B) : U :=
    (g    : B → A)
  × (linv : (x : A) → x = g (f x))
  × (rinv : (x : B) → f (g x) = x)
  × ((x : A) → refl ={i. f (linv x i) = f x} (rinv (f x)));

coe01isEquiv (A : I → U) : isEquiv (A 0) (A 1) (λ x. coe 0 1 A x) :=
  let f' (i : I)(x : A 0)           : A i := coe 0 i A x;
  let g' (i : I)(x : A i)           : A 0 := coe i 0 A x;
  let linv' (i : I)(x : A 0)(j : I) : A 0 := hcom 0 i (A 0) [j=0 k. x; j=1 k. coe k 0 A (coe 0 k A x)] x;
  let rinv' (i : I)(x : A i)(j : I) : A i := hcom i 0 (A i) [j=0 k. coe k i A (coe i k A x); j=1 k. x] x;

  ( λ x. g' 1 x
  , λ x j. linv' 1 x j
  , λ x j. rinv' 1 x j
  , λ x l k. hcom 0 1 (A 1) [k=0 i. coe i 1 A (f' i (linv' i x l))
                            ;k=1 i. coe i 1 A (f' i x)
		            ;l=0 i. coe i 1 A (f' i x)
		            ;l=1 i. coe i 1 A (rinv' i (f' i x) k)]
		            (coe 0 1 A x)
  );

coe01isIso (A : I → U) : isIso (A 0) (A 1) (λ x. coe 0 1 A x) :=
  let f' (i : I)(x : A 0)           : A i := coe 0 i A x;
  let g' (i : I)(x : A i)           : A 0 := coe i 0 A x;
  let linv' (i : I)(x : A 0)(j : I) : A 0 := hcom 0 i (A 0) [j=0 k. x; j=1 k. coe k 0 A (coe 0 k A x)] x;
  let rinv' (i : I)(x : A i)(j : I) : A i := hcom i 0 (A i) [j=0 k. coe k i A (coe i k A x); j=1 k. x] x;

  ( λ x. g' 1 x
  , λ x j. linv' 1 x j
  , λ x j. rinv' 1 x j
  );

coe10isEquiv (q : I → U) : isEquiv (q 1) (q 0) (λ x. coe 1 0 q x) :=
  let f' (i : I)(x : q 1)           : q i := coe 1 i q x;
  let g' (i : I)(x : q i)           : q 1 := coe i 1 q x;
  let linv' (i : I)(x : q 1)(j : I) : q 1 := hcom 1 i (q 1) [j=0 k. x; j=1 k. coe k 1 q (coe 1 k q x)] x;
  let rinv' (i : I)(x : q i)(j : I) : q i := hcom i 1 (q i) [j=0 k. coe k i q (coe i k q x); j=1 k. x] x;

  ( λ x. g' 0 x
  , λ x j. linv' 0 x j
  , λ x j. rinv' 0 x j
  , λ x l k. com 1 0 q [k=0 i. f' i (linv' i x l)
                       ;k=1 i. f' i x
		       ;l=0 i. f' i x
		       ;l=1 i. rinv' i (f' i x) k]
		       x
  );

coe10isEquivnf (q : I → U) : isEquiv (q 1) (q 0) (λ x. coe 1 0 q x) :=
  let B := q 0; let C := q 1;

( λ x. coe 0 1 q x
, λ x {x} {coe 0 1 q (coe 1 0 q x)} j. hcom 1 0 C [j = 0 k. x; j = 1 k. coe k 1 q (coe 1 k q x)] x
, λ x {coe 1 0 q (coe 0 1 q x)} {x} j. hcom 0 1 B [j = 0 k. coe k 0 q (coe 0 k q x); j = 1 k. x] x
, λ x {λ {coe 1 0 q x} {coe 1 0 q x} _. coe 1 0 q x}
      {λ {coe 1 0 q (coe 0 1 q (coe 1 0 q x))} {coe 1 0 q x} j.
             hcom 0 1 B [j = 0 k. coe k 0 q (coe 0 k q (coe 1 0 q x)); j = 1 k. coe 1 0 q x] (coe 1 0 q x)}
      l
      {coe 1 0 q (hcom 1 0 C [l = 0 k. x; l = 1 k. coe k 1 q (coe 1 k q x)] x)}
      {coe 1 0 q x}
      k. hcom 1 0 B [
            k = 0 i. coe i 0 q (coe 1 i q (hcom 1 i C [l = 0 k1. x; l = 1 k1. coe k1 1 q (coe 1 k1 q x)] x))
	  ; k = 1 i. coe i 0 q (coe 1 i q x)
	  ; l = 0 i. coe i 0 q (coe 1 i q x)
	  ; l = 1 i. coe i 0 q (hcom i 1 (q i) [k = 0 k1. coe k1 i q (coe i k1 q (coe 1 i q x))
	                                      ; k = 1 k1. coe 1 i q x]
					      (coe 1 i q x))]
	  (coe 1 0 q x));


equiv (A B : U) : U :=
  (f : A → B) × isEquiv A B f;

idEquiv (A : U) : equiv A A :=
  (λ x. x, λ x. x, λ x _. x, λ x _. x, λ x _ _. x);

ua (A B : U)(f : equiv A B) : A = B :=
  λ i. Glue B [i=0. (A, f); i=1. (B, idEquiv B)];

sym (A : U)(x y : A)(p : x = y) : y = x :=
  λ i. hcom 0 1 A [i = 0 j. p {x} {y} j; i = 1 _. x] x;

uafwd (A B : U)(f : equiv A B)(x : A) : B := coe 0 1 (ua A B f) x;

uabeta (A B : U)(f : equiv A B)(x : A) : coe 0 1 (ua A B f) x = f.1 x :=
  λ i. hcom 1 i B [] (hcom i 1 B [] (coe i 1 (_. B) (f.1 x)));

uabetainv (A B : U)(f : equiv A B)(x : B) : coe 1 0 (ua A B f) x = f.2.1 x :=
  λ i. hcom 1 i A [] (f.2.1 (hcom 1 i B [] (coe 1 i (_. B) x)));

comp (A : U)(x y z : A) (p : x = y) (q : y = z) : x = z
  := λ i. hcom 0 1 A [i=0 _. x; i=1. q] (p i);

trsu (A B C : U)(p : A = B)(q : B = C) : A = C := p ∙ q;

trsunf (A B C : U)(p : A = B)(q : B = C) : A = C :=
λ {A} {C} i. Glue (p {A} {B} i) [i = 0. A, λ x. coe 1 0 (_. A) x, λ
x. coe 0 1 (_. A) x, λ x {x} {coe 0 1 (_. A) (coe 1 0 (_. A) x)} j. hcom 1 0 A
[j = 0 k. x; j = 1 k. coe k 1 (_. A) (coe 1 k (_. A) x)] x, λ x {coe 1 0 (_. A)
(coe 0 1 (_. A) x)} {x} j. hcom 0 1 A [j = 0 k. coe k 0 (_. A) (coe 0 k (_. A)
x); j = 1 k. x] x, λ x {λ {coe 1 0 (_. A) x} {coe 1 0 (_. A) x} _. coe 1 0
(_. A) x} {λ {coe 1 0 (_. A) (coe 0 1 (_. A) (coe 1 0 (_. A) x))} {coe 1 0
(_. A) x} k. hcom 0 1 A [k = 0 k1. coe k1 0 (_. A) (coe 0 k1 (_. A) (coe 1 0
(_. A) x)); k = 1 k1. coe 1 0 (_. A) x] (coe 1 0 (_. A) x)} l {coe 1 0 (_. A)
(hcom 1 0 A [l = 0 k. x; l = 1 k. coe k 1 (_. A) (coe 1 k (_. A) x)] x)} {coe 1
0 (_. A) x} k. hcom 1 0 A [k = 0 i1. coe i1 0 (_. A) (coe 1 i1 (_. A) (hcom 1 i1
A [l = 0 k1. x; l = 1 k1. coe k1 1 (_. A) (coe 1 k1 (_. A) x)] x)); k = 1
i1. coe i1 0 (_. A) (coe 1 i1 (_. A) x); l = 0 i1. coe i1 0 (_. A) (coe 1 i1
(_. A) x); l = 1 i1. coe i1 0 (_. A) (hcom i1 1 A [k = 0 k1. coe k1 i1 (_. A)
(coe i1 k1 (_. A) (coe 1 i1 (_. A) x)); k = 1 k1. coe 1 i1 (_. A) x] (coe 1 i1
(_. A) x))] (coe 1 0 (_. A) x); i = 1. C, λ x. coe 1 0 q x, λ x. coe 0 1 q x, λ
x {x} {coe 0 1 q (coe 1 0 q x)} j. hcom 1 0 C [j = 0 k. x; j = 1 k. coe k 1 q
(coe 1 k q x)] x, λ x {coe 1 0 q (coe 0 1 q x)} {x} j. hcom 0 1 B [j = 0 k. coe
k 0 q (coe 0 k q x); j = 1 k. x] x, λ x {λ {coe 1 0 q x} {coe 1 0 q x} _. coe 1
0 q x} {λ {coe 1 0 q (coe 0 1 q (coe 1 0 q x))} {coe 1 0 q x} k. hcom 0 1 B [k =
0 k1. coe k1 0 q (coe 0 k1 q (coe 1 0 q x)); k = 1 k1. coe 1 0 q x] (coe 1 0 q
x)} l {coe 1 0 q (hcom 1 0 C [l = 0 k. x; l = 1 k. coe k 1 q (coe 1 k q x)] x)}
{coe 1 0 q x} k. hcom 1 0 B [k = 0 i1. coe i1 0 q (coe 1 i1 q (hcom 1 i1 C [l =
0 k1. x; l = 1 k1. coe k1 1 q (coe 1 k1 q x)] x)); k = 1 i1. coe i1 0 q (coe 1
i1 q x); l = 0 i1. coe i1 0 q (coe 1 i1 q x); l = 1 i1. coe i1 0 q (hcom i1 1 (q
{B} {C} i1) [k = 0 k1. coe k1 i1 q (coe i1 k1 q (coe 1 i1 q x)); k = 1 k1. coe 1
i1 q x] (coe 1 i1 q x))] (coe 1 0 q x)];


bighcom (x : U)(l : I) : U :=
  hcom 0 1 U [l = 0 i. Glue x [0=i. (x, idEquiv x)]] x;

bighcomnf (x : U)(l : I) : U :=
Glue x [l = 0. Glue x [], λ x1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i. x) (unglue x1))), λ x1. glue (hcom 1 0 x [] (hcom 0 1 x [] (coe 0 1 (i. x)
x1))) [] [], λ x1 {x1} {glue (hcom 1 0 x [] (hcom 0 1 x [] (coe 0 1 (i. x) (hcom
1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1))))))) [] []} j. glue (hcom 1
0 x [j = 0 k. unglue x1; j = 1 k. unglue (glue (hcom 1 0 x [k = 1 i. unglue x1]
(hcom k 1 x [] (coe k 1 (i. x) (hcom 1 0 x [1 = k i. unglue x1; 0 = k i. hcom 1
0 x [i = 0 i1. hcom 1 i1 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1))); i =
1 i1. hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0
(i1. x) (unglue x1)))] (hcom 1 k x [] (coe 1 k (i. x) (unglue x1))))))) [] [])]
(unglue x1)) [] [], λ x1 {hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (hcom 1 0
x [] (hcom 0 1 x [] (coe 0 1 (i. x) x1)))))} {x1} j. hcom 0 1 x [j = 0 k. hcom 1
0 x [k = 0 i. x1] (hcom k 0 x [] (coe k 0 (i. x) (hcom 1 0 x [0 = k i. x1; 0 = k
i. x1] (hcom 0 k x [] (coe 0 k (i. x) x1))))); j = 1 k. x1] x1, λ x1 {λ {hcom 1
0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1)))} {hcom 1 0 x [] (hcom 1 0 x
[] (coe 1 0 (i. x) (unglue x1)))} _. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i. x) (unglue x1)))} {λ {hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (hcom 1 0
x [] (hcom 0 1 x [] (coe 0 1 (i. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i. x) (unglue x1)))))))))} {hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x)
(unglue x1)))} k. hcom 0 1 x [k = 0 k1. hcom 1 0 x [k1 = 0 i. hcom 1 0 x []
(hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0 (i. x)
(hcom 1 0 x [0 = k1 i. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue
x1))); 0 = k1 i. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))]
(hcom 0 k1 x [] (coe 0 k1 (i. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x)
(unglue x1))))))))); k = 1 k1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x)
(unglue x1)))] (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1))))} l1
{hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i. x) (hcom 1 0 x [l1 = 0 k. unglue x1;
l1 = 1 k. unglue (glue (hcom 1 0 x [k = 1 i. unglue x1] (hcom k 1 x [] (coe k 1
(i. x) (hcom 1 0 x [1 = k i. unglue x1; 0 = k i. hcom 1 0 x [i = 0 i1. hcom 1 i1
x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1))); i = 1 i1. hcom 1 0 x [] (coe
1 0 (i2. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))] (hcom 1
k x [] (coe 1 k (i. x) (unglue x1))))))) [] [])] (unglue x1))))} {hcom 1 0 x []
(hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1)))} k. hcom 1 0 x [k = 0 i. hcom 1 0 x
[i = 0 i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (hcom 1 0 x [l1 = 0
k1. unglue x1; l1 = 1 k1. unglue (glue (hcom 1 0 x [k1 = 1 i2. unglue x1] (hcom
k1 1 x [] (coe k1 1 (i2. x) (hcom 1 0 x [1 = k1 i2. unglue x1; 0 = k1 i2. hcom 1
0 x [i2 = 0 i3. hcom 1 i3 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); i2
= 1 i3. hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0
(i3. x) (unglue x1)))] (hcom 1 k1 x [] (coe 1 k1 (i2. x) (unglue x1))))))) []
[])] (unglue x1))))] (hcom i 0 x [] (coe i 0 (i1. x) (hcom 1 0 x [1 = i
i1. unglue x1; 0 = i i1. hcom 1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x []
(coe 1 0 (i3. x) (hcom 1 0 x [l1 = 0 k1. unglue x1; l1 = 1 k1. unglue (glue
(hcom 1 0 x [k1 = 1 i3. unglue x1] (hcom k1 1 x [] (coe k1 1 (i3. x) (hcom 1 0 x
[1 = k1 i3. unglue x1; 0 = k1 i3. hcom 1 0 x [i3 = 0 i4. hcom 1 i4 x [] (hcom 1
0 x [] (coe 1 0 (i5. x) (unglue x1))); i3 = 1 i4. hcom 1 0 x [] (coe 1 0 (i5. x)
(unglue x1))] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 1 k1 x []
(coe 1 k1 (i3. x) (unglue x1))))))) [] [])] (unglue x1)))); i1 = 1 i2. hcom 1 0
x [] (coe 1 0 (i3. x) (hcom 1 0 x [l1 = 0 k1. unglue x1; l1 = 1 k1. unglue (glue
(hcom 1 0 x [k1 = 1 i3. unglue x1] (hcom k1 1 x [] (coe k1 1 (i3. x) (hcom 1 0 x
[1 = k1 i3. unglue x1; 0 = k1 i3. hcom 1 0 x [i3 = 0 i4. hcom 1 i4 x [] (hcom 1
0 x [] (coe 1 0 (i5. x) (unglue x1))); i3 = 1 i4. hcom 1 0 x [] (coe 1 0 (i5. x)
(unglue x1))] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 1 k1 x []
(coe 1 k1 (i3. x) (unglue x1))))))) [] [])] (unglue x1)))] (hcom 1 0 x [] (coe 1
0 (i2. x) (hcom 1 0 x [l1 = 0 k1. unglue x1; l1 = 1 k1. unglue (glue (hcom 1 0 x
[k1 = 1 i2. unglue x1] (hcom k1 1 x [] (coe k1 1 (i2. x) (hcom 1 0 x [1 = k1
i2. unglue x1; 0 = k1 i2. hcom 1 0 x [i2 = 0 i3. hcom 1 i3 x [] (hcom 1 0 x []
(coe 1 0 (i4. x) (unglue x1))); i2 = 1 i3. hcom 1 0 x [] (coe 1 0 (i4. x)
(unglue x1))] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom 1 k1 x []
(coe 1 k1 (i2. x) (unglue x1))))))) [] [])] (unglue x1))))] (hcom 1 i x [] (coe
1 i (i1. x) (hcom 1 i x [l1 = 0 k1. unglue x1; l1 = 1 k1. unglue (glue (hcom 1 0
x [k1 = 1 i1. unglue x1] (hcom k1 1 x [] (coe k1 1 (i1. x) (hcom 1 0 x [1 = k1
i1. unglue x1; 0 = k1 i1. hcom 1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x []
(coe 1 0 (i3. x) (unglue x1))); i1 = 1 i2. hcom 1 0 x [] (coe 1 0 (i3. x)
(unglue x1))] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom 1 k1 x []
(coe 1 k1 (i1. x) (unglue x1))))))) [] [])] (unglue x1))))))); k = 1 i. hcom 1 0
x [i = 0 i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom
i 0 x [] (coe i 0 (i1. x) (hcom 1 0 x [1 = i i1. unglue x1; 0 = i i1. hcom 1 0 x
[i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))); i1 = 1
i2. hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i2. x)
(unglue x1)))] (hcom 1 i x [] (coe 1 i (i1. x) (unglue x1)))))); l1 = 0 i. hcom
1 0 x [i = 0 i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))]
(hcom i 0 x [] (coe i 0 (i1. x) (hcom 1 0 x [1 = i i1. unglue x1; 0 = i i1. hcom
1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)));
i1 = 1 i2. hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0
(i2. x) (unglue x1)))] (hcom 1 i x [] (coe 1 i (i1. x) (unglue x1)))))); l1 = 1
i. hcom 1 0 x [i = 0 i1. hcom 0 1 x [k = 0 k1. hcom 1 0 x [k1 = 0 i2. hcom 1 0 x
[] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0
(i2. x) (hcom 1 0 x [0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x)
(unglue x1))); 0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue
x1)))] (hcom 0 k1 x [] (coe 0 k1 (i2. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i2. x) (unglue x1))))))))); k = 1 k1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i2. x) (unglue x1)))] (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue
x1))))] (hcom i 0 x [] (coe i 0 (i1. x) (hcom i 1 x [k = 0 k1. unglue (glue
(hcom 1 0 x [k1 = i i1. hcom 1 0 x [1 = i i2. unglue x1; 0 = i i2. hcom 1 0 x
[i2 = 0 i3. hcom 1 i3 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); i2 = 1
i3. hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i3. x)
(unglue x1)))] (hcom 1 i x [] (coe 1 i (i2. x) (unglue x1))); 0 = i i1. hcom 1 0
x [i1 = 0 i2. hcom 1 i2 x [k1 = 0 i3. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i4. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0 (i3. x) (hcom 1 0 x [0 = k1
i3. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); 0 = k1 i3. hcom
1 0 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 0 k1 x [] (coe 0
k1 (i3. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))))))));
i1 = 1 i2. hcom k1 0 x [] (coe k1 0 (i3. x) (hcom 1 0 x [0 = k1 i3. hcom 1 0 x
[] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); 0 = k1 i3. hcom 1 0 x [] (hcom
1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 0 k1 x [] (coe 0 k1 (i3. x) (hcom
1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))))))); k1 = 0 i2. hcom 1 0
x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0
(i2. x) (hcom 1 0 x [0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x)
(unglue x1))); 0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue
x1)))] (hcom 0 k1 x [] (coe 0 k1 (i2. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i2. x) (unglue x1)))))))))] (hcom k1 i x [] (coe k1 i (i1. x) (hcom 1 0 x [i =
k1 i1. hcom 1 0 x [1 = i i2. unglue x1; 0 = i i2. hcom 1 0 x [i2 = 0 i3. hcom 1
i3 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1))); i2 = 1 i3. hcom 1 0 x []
(coe 1 0 (i4. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))]
(hcom 1 i x [] (coe 1 i (i2. x) (unglue x1))); 0 = k1 i1. hcom 1 0 x [i1 = 0
i2. hcom 1 i2 x [i = 0 i3. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue
x1)))] (hcom i 0 x [] (coe i 0 (i3. x) (hcom 1 0 x [1 = i i3. unglue x1; 0 = i
i3. hcom 1 0 x [i3 = 0 i4. hcom 1 i4 x [] (hcom 1 0 x [] (coe 1 0 (i5. x)
(unglue x1))); i3 = 1 i4. hcom 1 0 x [] (coe 1 0 (i5. x) (unglue x1))] (hcom 1 0
x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 1 i x [] (coe 1 i (i3. x) (unglue
x1)))))); i1 = 1 i2. hcom i 0 x [] (coe i 0 (i3. x) (hcom 1 0 x [1 = i
i3. unglue x1; 0 = i i3. hcom 1 0 x [i3 = 0 i4. hcom 1 i4 x [] (hcom 1 0 x []
(coe 1 0 (i5. x) (unglue x1))); i3 = 1 i4. hcom 1 0 x [] (coe 1 0 (i5. x)
(unglue x1))] (hcom 1 0 x [] (coe 1 0 (i4. x) (unglue x1)))] (hcom 1 i x [] (coe
1 i (i3. x) (unglue x1))))); i = 0 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i3. x) (unglue x1)))] (hcom i 0 x [] (coe i 0 (i2. x) (hcom 1 0 x [1 = i
i2. unglue x1; 0 = i i2. hcom 1 0 x [i2 = 0 i3. hcom 1 i3 x [] (hcom 1 0 x []
(coe 1 0 (i4. x) (unglue x1))); i2 = 1 i3. hcom 1 0 x [] (coe 1 0 (i4. x)
(unglue x1))] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom 1 i x [] (coe
1 i (i2. x) (unglue x1))))))] (hcom i k1 x [] (coe i k1 (i1. x) (hcom 1 0 x [1 =
i i1. unglue x1; 0 = i i1. hcom 1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x []
(coe 1 0 (i3. x) (unglue x1))); i1 = 1 i2. hcom 1 0 x [] (coe 1 0 (i3. x)
(unglue x1))] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom 1 i x [] (coe
1 i (i1. x) (unglue x1)))))))))) [0 = i. x, λ x2. x2, λ x2. x2, λ x2 {x2} {x2}
_. x2, λ x2 {x2} {x2} _. x2, λ x2 {λ {x2} {x2} _. x2} {λ {x2} {x2} _. x2} _ {x2}
{x2} _. x2] [0 = i. hcom 1 0 x [k1 = 0 i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i2. x) (unglue x1)))] (hcom k1 0 x [] (coe k1 0 (i1. x) (hcom 1 0 x [0 = k1
i1. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1))); 0 = k1 i1. hcom
1 0 x [] (hcom 1 0 x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom 0 k1 x [] (coe 0
k1 (i1. x) (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))))))))]);
k = 1 k1. unglue (glue (hcom 1 0 x [1 = i i1. unglue x1; 0 = i i1. hcom 1 0 x
[i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))); i1 = 1
i2. hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))] (hcom 1 0 x [] (coe 1 0 (i2. x)
(unglue x1)))] (hcom 1 i x [] (coe 1 i (i1. x) (unglue x1)))) [0 = i. x, λ
x2. x2, λ x2. x2, λ x2 {x2} {x2} _. x2, λ x2 {x2} {x2} _. x2, λ x2 {λ {x2} {x2}
_. x2} {λ {x2} {x2} _. x2} _ {x2} {x2} _. x2] [0 = i. hcom 1 0 x [] (hcom 1 0 x
[] (coe 1 0 (i1. x) (unglue x1)))]); 0 = i i1. hcom 0 i1 x [k = 0 k1. hcom 1 0 x
[k1 = 0 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1)))] (hcom
k1 0 x [] (coe k1 0 (i2. x) (hcom 1 0 x [0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x []
(coe 1 0 (i3. x) (unglue x1))); 0 = k1 i2. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i3. x) (unglue x1)))] (hcom 0 k1 x [] (coe 0 k1 (i2. x) (hcom 1 0 x [] (hcom 1
0 x [] (coe 1 0 (i2. x) (unglue x1))))))))); k = 1 k1. hcom 1 0 x [] (hcom 1 0 x
[] (coe 1 0 (i2. x) (unglue x1)))] (hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0
(i2. x) (unglue x1))))] (unglue (glue (hcom 1 0 x [1 = i i1. unglue x1; 0 = i
i1. hcom 1 0 x [i1 = 0 i2. hcom 1 i2 x [] (hcom 1 0 x [] (coe 1 0 (i3. x)
(unglue x1))); i1 = 1 i2. hcom 1 0 x [] (coe 1 0 (i3. x) (unglue x1))] (hcom 1 0
x [] (coe 1 0 (i2. x) (unglue x1)))] (hcom 1 i x [] (coe 1 i (i1. x) (unglue
x1)))) [0 = i. x, λ x2. x2, λ x2. x2, λ x2 {x2} {x2} _. x2, λ x2 {x2} {x2}
_. x2, λ x2 {λ {x2} {x2} _. x2} {λ {x2} {x2} _. x2} _ {x2} {x2} _. x2] [0 =
i. hcom 1 0 x [] (hcom 1 0 x [] (coe 1 0 (i1. x) (unglue x1)))])))))] (hcom 1 0
x [] (hcom 1 0 x [] (coe 1 0 (i. x) (unglue x1))))];

-- sym (A : U)(x y : A) (p : x = y) : y = x
--   := λ i. hcom 0 1 [i=0. p; i=1 _. x] x;

-- ua (A B : U)(f : equiv A B) : A = B :=
--   λ i. Glue B [i=0. (A, f); i=1. (B, idEquiv B)];

-- -- TODO: Can't recheck!
-- uasym (A B : U)(f : equiv A B)(i : I) : U :=
--   -- Glue A [i=0. B, λ x. coe 1 0 (ua A B f) x, coe10isEquiv (λ i. ua A B f i)];

-- culprit: coeisEquiv (λ i. ua A B f i)

-- coeg1 (i j : I)(A : I → U)(x : Glue (A i) []) : Glue (A j) [] :=
--     coe i j (k. Glue (A k) []) x;

-- coeg2 (i j : I)(A : I → U)(x : Glue (A i) [i=0. A i, idEquiv (A i)]) : Glue (A j) [i=0. A j, idEquiv (A j)] :=
--     coe i j (k. Glue (A k) [i=0. A k, idEquiv (A k)]) x;

-- coeg3 (i j : I)(A : I → U)(f : (i : I) → equiv (A i) (A i))
--       (x : Glue (A i) [i=0. A i, f i]) : Glue (A j) [j=0. A j, f j; i=0. A i, f i] :=
--   coe i j (k. Glue (A k) [k=0. A k, f k; i=0. A k, f k]) x;
