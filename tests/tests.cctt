
isEquiv (A B : U)(f : A → B) : U :=
    (g    : B → A)
  × (linv : (x : A) → x = g (f x))
  × (rinv : (x : B) → f (g x) = x)
  × ((x : A) → refl ={i. f (linv x i) = f x} (rinv (f x)));

equiv (A B : U) : U :=
  (f : A → B) × isEquiv A B f;

idEquiv (A : U) : equiv A A :=
  (λ x. x, λ x. x, λ x _. x, λ x _. x, λ x _ _. x);

symufill (A B : U)(P : A = B)(i j : I) : U :=
-- hcom 0 j U [i=0. P; i=1 _. A] A;

Glue A [
   0 = j. A, idEquiv A
  ;i = 0. P j
  ;j = 1. foo];

{-
Glue A [
  0 = j. A, idEquiv A
 ;i = 0. P j
       , λ x. coe 0 j P x
       , λ x. coe j 0 P x
       , λ x j1. hcom 0 j [j1 = 0 k. x; j1 = 1 k. coe k 0 P (coe 0 k P x)] x
       , λ x j1. hcom j 0 [j1 = 0 k. coe k j P (coe j k P x); j1 = 1 k. x] x
       , λ x l k. hcom 0 j [k = 0 i1. coe i1 j P (coe 0 i1 P
                   (hcom 0 i1 [l = 0 k1. x; l = 1 k1. coe k1 0 P (coe 0 k1 P x)] x)); k = 1 i1. coe
                   i1 j P (coe 0 i1 P x); l = 0 i1. coe i1 j P (coe 0 i1 P x); l = 1 i1. coe i1 j P
                   (hcom i1 0 [k = 0 k1. coe k1 i1 P (coe i1 k1 P (coe 0 i1 P x)); k = 1 k1. coe 0
                   i1 P x] (coe 0 i1 P x))] (coe 0 j P x)

  ;i = 1. A
        , λ x. coe 0 j (_. A) x
	, λ x. coe j 0 (_. A) x
	, λ x j1. hcom 0 j [j1 = 0 k. x; j1 = 1 k. coe k 0 (_. A) (coe 0 k (_. A) x)] x
        , λ x j1. hcom j 0 [j1 = 0 k. coe k j (_. A) (coe j k (_. A) x); j1 = 1 k. x] x
        , λ x l k. hcom 0 j [k = 0 i1. coe i1 j (_. A) (coe 0
               i1 (_. A) (hcom 0 i1 [l = 0 k1. x; l = 1 k1. coe k1 0 (_. A) (coe 0 k1 (_. A)
               x)] x)); k = 1 i1. coe i1 j (_. A) (coe 0 i1 (_. A) x); l = 0 i1. coe i1 j
               (_. A) (coe 0 i1 (_. A) x); l = 1 i1. coe i1 j (_. A) (hcom i1 0 [k = 0 k1. coe
               k1 i1 (_. A) (coe i1 k1 (_. A) (coe 0 i1 (_. A) x)); k = 1 k1. coe 0 i1 (_. A)
               x] (coe 0 i1 (_. A) x))] (coe 0 j (_. A) x)];
-}


-- symDep (A B : U) (P : A = B) (a : A) (b : B) (p : a ={P} b) : b ={P⁻¹} a :=
--   λ i. com 0 1 (j. hcom 0 j U [i=0. P; i=1 _. A] A)
--                 [i=0 j. p j; i=1 j. a] a;