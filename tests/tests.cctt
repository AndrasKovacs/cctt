
fib (A B : U)(f : A → B)(b : B) : U := (a : A) × f a = b;

comFib (A B : U)(f : A → B)(y : B)(base : fib A B f y) : fib A B f y :=
  hcom 0 1 (fib A B f y) [] base;


-- λ A B f b base.
  -- ( hcom 0 1 A [] base.1
  -- , λ j. hcom 0 1 B [ j = 0 i. f (hcom 0 i [] base.1) ; j = 1 i. y] (base.2 j));


λ A B f y base.
  ( hcom 0 1 [] base.1
  , λ _. hcom 0 1 [@0 = 0 i. f (hcom 0 1 [] base.1); @0 = 1 i. y]
           (hcom 0 1 [@0 = 0 i. f (hcom 0 i [] base.1); @0 = 1 i. y]
	     (base.2 @0)))



{-
-- hcom over fib:

hcom r r' ((x : A) * f x = y) [α i. t i] b =
  ( hcom r r' A [α i. (t i).1] b.1
  , λ j. hcom r r' B [j=0 i. f (hcom r i A [α k. (t k).1] b.1)
                     ;j=1 i. y
		     ;α i. (t i).2 j]
		     (b.2 j))

-}



--------------------------------------------------------------------------------


-- myRefl (A : U) (a : A) : a = a := refl;

-- sym (A : U) (x y : A)(p : x = y) : y = x := p ⁻¹;

-- trans (A : U)(x y z : A)(p : x = y) (q : y = z) : x = z := p ∙ q;

-- myAp (A B : U)(f : A → B)(x y : A)(p : x = y) : f x = f y := ap f p;

-- badSym (A B : U)(P : A = B)(x : A)(y : B)(p : x ={P} y) : y ={P⁻¹} x := p⁻¹;



-- testPathEta (A : U) (a b : A) (p : a = b) : p = (λ i. p i)
--   := refl;

-- comp (A : U)(x y z : A) (p : x = y) (q : y = z) : x = z
--   := λ i. hcom 0 1 [i=0 _. x; i=1. q] (p i);

-- -- Definitional equality drops components with false cofibrations:
-- cofEq (A : U)(x : A)(i : I) : A := hcom 0 1 [i=0,i=1 _. x] x;

-- -- fibtest (A B : U)(f : A → B)(b : B)(base base' : (a : A) × f a = b)
-- --         (p : base = base')(i : I) : (a : A) × f a = b
-- --   := hcom 0 1 [i=0. p] base;


--------------------------------------------------------------------------------

-- foo := U;

-- test (A : U)(A : U)(A : U) : U := @@0;

--------------------------------------------------------------------------------

-- symUtest (A B : U)(p : A = B) : B = A := λ i. hcom 0 1 [i=0. p; i=1 _. A] A;

-- Glue A [

--   i = 0.
--       B
--     , (λ x. coe 1 0 (j. p j) x)
--     , (λ x. coe 0 1 (j. p j) x)
--     , (λ x j. hcom 1 0 [j = 0 k. x; j = 1 k. coe k 1 (j1. p j1) (coe 1 k (j1. p j1) x)] x)
--     , (λ x j. hcom 0 1 [j = 0 k. coe k 0 (j1. p j1) (coe 0 k (j1. p j1) x); j = 1 k. x] x)
--     , TODO;

--   i = 1.
--       A
--     , (λ x. coe 1 0 (_. A) x)
--     , (λ x. coe 0 1 (_. A) x)
--     , (λ x j. hcom 1 0 [j = 0 k. x; j = 1 k. coe k 1 (_. A) (coe 1 k (_. A) x)] x)
--     , (λ x j. hcom 0 1 [j = 0 k. coe k 0 (_. A) (coe 0 k (_. A) x); j = 1 k. x] x)
--     , TODO]