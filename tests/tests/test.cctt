
import basics;


-- coe01isEquivNf (A : I → U) : isEquiv (A 0) (A 1)  (λ x. coe 0 1 A x) :=
--   (λ x. coe 1 0 A x
-- , λ x {coe 1 0 A (coe 0 1 A x)} {x} j. hcom 0 1 (A 0) [j = 0 k. coe k 0 A (coe 0 k A x); j = 1 k. x] x


pathToEquiv (A B : U)(p : A = B) : equiv A B :=
  ((λ x. coe 0 1 p x), coeIsEquiv (λ i. p i) 0 1);

uaTrip (A B : U)(f : equiv A B) : equiv A B :=
  pathToEquiv A B (ua A B f);

-- HAS an empty hcom!
coe0i (A B : U)(f : equiv A B)(i : I)(x : A) := coe 0 i (ua A B f) x;


coei0 (A B : U)(f : equiv A B)(i : I)(x : ua A B f i) := coe i 0 (ua A B f) x;
coe01 (A B : U)(f : equiv A B)(x : A) := coe 0 1 (ua A B f) x;
coe10 (A B : U)(f : equiv A B)(x : B) := coe 1 0 (ua A B f) x;
coek00k (A B : U)(f : equiv A B)(x : A)(k : I) := coe k 0 (ua A B f) (coe 0 k (ua A B f) x);

-- foo (A : U)(x : A)(i : I) : hcom 0 1 [i = 0 _. x] x = hcom 0 1 [0 = i _. x] x := refl;

uaTripNf (A B : U)(f : equiv A B) : equiv A B :=
(λ x. coe 0 1 (i. B) (f.f x), λ x. f.g (coe 1 0 (j. B) x), λ x {f.g
(coe 1 0 (j. B) (coe 0 1 (i. B) (f.f x)))} {x} j. hcom 0 1 A [j = 0 k. hcom 0 1
A [k = 0 i. f.linv x {f.g (f.f x)} {x} i; k = 1 l. f.g (coe 1 0 (l. B) (coe 0 1
(l. B) (f.f x)))] (f.g (coe k 0 (l. B) (hcom 1 0 B [k = 0 i. f.f x; k = 0 j. f.f
x; k = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (l. B) (f.f x); j = 1 i. coe 0 1 (l. B)
(f.f x)] (coe 0 1 (l. B) (f.f x))] (coe 0 k (l. B) (f.f x))))); j = 1 k. x] x, λ
x {coe 0 1 (i. B) (f.f (f.g (coe 1 0 (j. B) x)))} {x} j. hcom 1 0 B [j = 0
k. hcom 0 1 B [k = 1 i. x; k = 0 l. coe 0 1 (l. B) (f.f (f.g (coe 1 0 (l. B)
x)))] (coe k 1 (l. B) (hcom 1 0 B [k = 1 i. x; k = 0 j. hcom 0 1 B [j = 0 i. f.f
(f.g (coe 1 0 (l. B) x)); j = 1 i. coe 1 0 (l. B) x] (f.rinv (coe 1 0 (l. B) x)
{f.f (f.g (coe 1 0 (l. B) x))} {coe 1 0 (l. B) x} j); k = 1 j. x] (coe 1 k
(l. B) x))); j = 1 k. x] x, λ x {λ {coe 0 1 (i. B) (f.f (f.g (coe 1 0 (j. B)
(coe 0 1 (i. B) (f.f x)))))} {coe 0 1 (i. B) (f.f x)} j. hcom 1 0 B [j = 0
k. hcom 0 1 B [k = 1 i. coe 0 1 (i. B) (f.f x); k = 0 l. coe 0 1 (l. B) (f.f
(f.g (coe 1 0 (l. B) (coe 0 1 (i. B) (f.f x)))))] (coe k 1 (l. B) (hcom 1 0 B [k
= 1 i. coe 0 1 (i. B) (f.f x); k = 0 j. hcom 0 1 B [j = 0 i. f.f (f.g (coe 1 0
(l. B) (coe 0 1 (i. B) (f.f x)))); j = 1 i. coe 1 0 (l. B) (coe 0 1 (i. B) (f.f
x))] (f.rinv (coe 1 0 (l. B) (coe 0 1 (i. B) (f.f x))) {f.f (f.g (coe 1 0 (l. B)
(coe 0 1 (i. B) (f.f x))))} {coe 1 0 (l. B) (coe 0 1 (i. B) (f.f x))} j); k = 1
j. coe 0 1 (i. B) (f.f x)] (coe 1 k (l. B) (coe 0 1 (i. B) (f.f x))))); j = 1
k. coe 0 1 (i. B) (f.f x)] (coe 0 1 (i. B) (f.f x))} {λ {coe 0 1 (i. B) (f.f x)}
{coe 0 1 (i. B) (f.f x)} _. coe 0 1 (i. B) (f.f x)} l {coe 0 1 (i. B) (f.f (hcom
0 1 A [l = 0 k. hcom 0 1 A [k = 0 i. f.linv x {f.g (f.f x)} {x} i; k = 1 l. f.g
(coe 1 0 (l. B) (coe 0 1 (l. B) (f.f x)))] (f.g (coe k 0 (l. B) (hcom 1 0 B [k =
0 i. f.f x; k = 0 j. f.f x; k = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (l. B) (f.f
x); j = 1 i. coe 0 1 (l. B) (f.f x)] (coe 0 1 (l. B) (f.f x))] (coe 0 k (l. B)
(f.f x))))); l = 1 k. x] x))} {coe 0 1 (i. B) (f.f x)} k. hcom 0 1 B [k = 0
i. hcom 0 1 B [i = 1 i. coe 0 1 (j. B) (f.f (hcom 0 1 A [l = 0 k. hcom 0 1 A [k
= 0 i. f.linv x {f.g (f.f x)} {x} i; k = 1 l. f.g (coe 1 0 (l. B) (coe 0 1
(l. B) (f.f x)))] (f.g (coe k 0 (l. B) (hcom 1 0 B [k = 0 i. f.f x; k = 0 j. f.f
x; k = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (l. B) (f.f x); j = 1 i. coe 0 1 (l. B)
(f.f x)] (coe 0 1 (l. B) (f.f x))] (coe 0 k (l. B) (f.f x))))); l = 1 k. x] x));
i = 0 l. coe 0 1 (i. B) (f.f x)] (coe i 1 (i. B) (hcom 1 0 B [i = 0 i. f.f x; i
= 0 j. f.f x; i = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B) (f.f (hcom 0 1 A [l =
0 k. hcom 0 1 A [k = 0 i. f.linv x {f.g (f.f x)} {x} i; k = 1 l. f.g (coe 1 0
(l. B) (coe 0 1 (l. B) (f.f x)))] (f.g (coe k 0 (l. B) (hcom 1 0 B [k = 0 i. f.f
x; k = 0 j. f.f x; k = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (l. B) (f.f x); j = 1
i. coe 0 1 (l. B) (f.f x)] (coe 0 1 (l. B) (f.f x))] (coe 0 k (l. B) (f.f
x))))); l = 1 k. x] x)); j = 1 i. coe 0 1 (j. B) (f.f (hcom 0 1 A [l = 0 k. hcom
0 1 A [k = 0 i. f.linv x {f.g (f.f x)} {x} i; k = 1 l. f.g (coe 1 0 (l. B) (coe
0 1 (l. B) (f.f x)))] (f.g (coe k 0 (l. B) (hcom 1 0 B [k = 0 i. f.f x; k = 0
j. f.f x; k = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (l. B) (f.f x); j = 1 i. coe 0 1
(l. B) (f.f x)] (coe 0 1 (l. B) (f.f x))] (coe 0 k (l. B) (f.f x))))); l = 1
k. x] x))] (coe 0 1 (j. B) (f.f (hcom 0 1 A [l = 0 k. hcom 0 1 A [k = 0
i. f.linv x {f.g (f.f x)} {x} i; k = 1 l. f.g (coe 1 0 (l. B) (coe 0 1 (l. B)
(f.f x)))] (f.g (coe k 0 (l. B) (hcom 1 0 B [k = 0 i. f.f x; k = 0 j. f.f x; k =
1 j. hcom 0 1 B [j = 0 i. coe 0 1 (l. B) (f.f x); j = 1 i. coe 0 1 (l. B) (f.f
x)] (coe 0 1 (l. B) (f.f x))] (coe 0 k (l. B) (f.f x))))); l = 1 k. x] x)))]
(coe 0 i (j. B) (f.f (hcom 0 i A [l = 0 k. hcom 0 1 A [k = 0 i. f.linv x {f.g
(f.f x)} {x} i; k = 1 l. f.g (coe 1 0 (l. B) (coe 0 1 (l. B) (f.f x)))] (f.g
(coe k 0 (l. B) (hcom 1 0 B [k = 0 i. f.f x; k = 0 j. f.f x; k = 1 j. hcom 0 1 B
[j = 0 i. coe 0 1 (l. B) (f.f x); j = 1 i. coe 0 1 (l. B) (f.f x)] (coe 0 1
(l. B) (f.f x))] (coe 0 k (l. B) (f.f x))))); l = 1 k. x] x))))); k = 1 i. hcom
0 1 B [i = 1 i. coe 0 1 (j. B) (f.f x); i = 0 l. coe 0 1 (i. B) (f.f x)] (coe i
1 (i. B) (hcom 1 0 B [i = 0 i. f.f x; i = 0 j. f.f x; i = 1 j. hcom 0 1 B [j = 0
i. coe 0 1 (j. B) (f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f
x))] (coe 0 i (j. B) (f.f x)))); l = 0 i. hcom 0 1 B [i = 1 i. hcom 1 0 B [k = 0
k. hcom 0 1 B [k = 1 i. coe 0 1 (j. B) (f.f x); k = 0 l. coe 0 1 (l. B) (f.f
(f.g (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x)))))] (coe k 1 (l. B) (hcom 1 0 B [k
= 1 i. coe 0 1 (j. B) (f.f x); k = 0 j. hcom 0 1 B [j = 0 i. f.f (f.g (coe 1 0
(l. B) (coe 0 1 (j. B) (f.f x)))); j = 1 i. coe 1 0 (l. B) (coe 0 1 (j. B) (f.f
x))] (f.rinv (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x))) {f.f (f.g (coe 1 0 (l. B)
(coe 0 1 (j. B) (f.f x))))} {coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x))} j); k = 1
j. coe 0 1 (j. B) (f.f x)] (coe 1 k (l. B) (coe 0 1 (j. B) (f.f x))))); k = 1
k. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x)); i = 0 l. coe 0 1 (i. B)
(f.f x)] (coe i 1 (i. B) (hcom i 0 B [k = 0 k. hcom 1 0 B [i = k i. hcom 1 0 B
[@2 = 0 i. f.f x; @2 = 0 j. f.f x; @2 = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B)
(f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))] (coe 0 @2
(j. B) (f.f x)); i = 0 j. hcom 0 1 B [j = 0 i. f.f (hcom 0 i A [k = 0 i. f.linv
x {f.g (f.f x)} {x} i; k = 1 l. f.g (coe 1 0 (l. B) (coe 0 1 (l. B) (f.f x)))]
(f.g (coe k 0 (l. B) (hcom 1 0 B [k = 0 i. f.f x; k = 0 j. f.f x; k = 1 j. hcom
0 1 B [j = 0 i. coe 0 1 (l. B) (f.f x); j = 1 i. coe 0 1 (l. B) (f.f x)] (coe 0
1 (l. B) (f.f x))] (coe 0 k (l. B) (f.f x)))))); j = 1 i. coe k 0 (l. B) (hcom 1
0 B [k = 0 i. f.f x; k = 0 j. f.f x; k = 1 j. hcom 0 1 B [j = 0 i. coe 0 1
(l. B) (f.f x); j = 1 i. coe 0 1 (l. B) (f.f x)] (coe 0 1 (l. B) (f.f x))] (coe
0 k (l. B) (f.f x))); k = 0 i. f.coh x {f.rinv (f.f x)} {λ {f.f x} {f.f x}
_. f.f x} i {f.f (f.linv x {f.g (f.f x)} {x} i)} {f.f x} j] (f.rinv (coe k 0
(l. B) (hcom 1 0 B [k = 0 i. f.f x; k = 0 j. f.f x; k = 1 j. hcom 0 1 B [j = 0
i. coe 0 1 (l. B) (f.f x); j = 1 i. coe 0 1 (l. B) (f.f x)] (coe 0 1 (l. B) (f.f
x))] (coe 0 k (l. B) (f.f x)))) {f.f (f.g (coe k 0 (l. B) (hcom 1 0 B [k = 0
i. f.f x; k = 0 j. f.f x; k = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (l. B) (f.f x);
j = 1 i. coe 0 1 (l. B) (f.f x)] (coe 0 1 (l. B) (f.f x))] (coe 0 k (l. B) (f.f
x)))))} {coe k 0 (l. B) (hcom 1 0 B [k = 0 i. f.f x; k = 0 j. f.f x; k = 1
j. hcom 0 1 B [j = 0 i. coe 0 1 (l. B) (f.f x); j = 1 i. coe 0 1 (l. B) (f.f x)]
(coe 0 1 (l. B) (f.f x))] (coe 0 k (l. B) (f.f x)))} j); i = 1 j. hcom 0 1 B [j
= 0 i. hcom 0 i B [k = 1 i. coe 0 1 (j. B) (f.f x); k = 0 l. coe 0 1 (l. B) (f.f
(f.g (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x)))))] (coe k 1 (l. B) (hcom 1 0 B [k
= 1 i. coe 0 1 (j. B) (f.f x); k = 0 j. hcom 0 1 B [j = 0 i. f.f (f.g (coe 1 0
(l. B) (coe 0 1 (j. B) (f.f x)))); j = 1 i. coe 1 0 (l. B) (coe 0 1 (j. B) (f.f
x))] (f.rinv (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x))) {f.f (f.g (coe 1 0 (l. B)
(coe 0 1 (j. B) (f.f x))))} {coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x))} j); k = 1
j. coe 0 1 (j. B) (f.f x)] (coe 1 k (l. B) (coe 0 1 (j. B) (f.f x))))); j = 1
i. coe k 1 (l. B) (hcom 1 0 B [k = 1 i. coe 0 1 (j. B) (f.f x); k = 0 j. hcom 0
1 B [j = 0 i. f.f (f.g (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x)))); j = 1 i. coe
1 0 (l. B) (coe 0 1 (j. B) (f.f x))] (f.rinv (coe 1 0 (l. B) (coe 0 1 (j. B)
(f.f x))) {f.f (f.g (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x))))} {coe 1 0 (l. B)
(coe 0 1 (j. B) (f.f x))} j); k = 1 j. coe 0 1 (j. B) (f.f x)] (coe 1 k (l. B)
(coe 0 1 (j. B) (f.f x)))); k = 1 i. coe 0 1 (j. B) (f.f x)] (coe k 1 (l. B)
(hcom 1 0 B [k = 1 i. coe 0 1 (j. B) (f.f x); k = 0 j. hcom 0 1 B [j = 0 i. f.f
(f.g (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x)))); j = 1 i. coe 1 0 (l. B) (coe 0
1 (j. B) (f.f x))] (f.rinv (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x))) {f.f (f.g
(coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x))))} {coe 1 0 (l. B) (coe 0 1 (j. B) (f.f
x))} j); k = 1 j. coe 0 1 (j. B) (f.f x)] (coe 1 k (l. B) (coe 0 1 (j. B) (f.f
x)))))] (coe k i (l. B) (hcom 1 0 B [i = k i. hcom 1 0 B [@2 = 0 i. f.f x; @2 =
0 j. f.f x; @2 = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B) (f.f x); j = 1 i. coe
0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))] (coe 0 @2 (j. B) (f.f x)); k = 0
j. hcom 0 1 B [j = 0 i. f.f (hcom 0 i A [@2 = 0 i. f.linv x {f.g (f.f x)} {x} i;
@2 = 1 l. f.g (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x)))] (f.g (coe @2 0 (l. B)
(hcom 1 0 B [@2 = 0 i. f.f x; @2 = 0 j. f.f x; @2 = 1 j. hcom 0 1 B [j = 0
i. coe 0 1 (j. B) (f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f
x))] (coe 0 @2 (j. B) (f.f x)))))); j = 1 i. coe @2 0 (l. B) (hcom 1 0 B [@2 = 0
i. f.f x; @2 = 0 j. f.f x; @2 = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B) (f.f
x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))] (coe 0 @2 (j. B)
(f.f x))); i = 0 i. f.coh x {f.rinv (f.f x)} {λ {f.f x} {f.f x} _. f.f x} i {f.f
(f.linv x {f.g (f.f x)} {x} i)} {f.f x} j] (f.rinv (coe i 0 (l. B) (hcom 1 0 B
[i = 0 i. f.f x; i = 0 j. f.f x; i = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B)
(f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))] (coe 0 i
(j. B) (f.f x)))) {f.f (f.g (coe i 0 (l. B) (hcom 1 0 B [i = 0 i. f.f x; i = 0
j. f.f x; i = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B) (f.f x); j = 1 i. coe 0 1
(j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))] (coe 0 i (j. B) (f.f x)))))} {coe i 0
(l. B) (hcom 1 0 B [i = 0 i. f.f x; i = 0 j. f.f x; i = 1 j. hcom 0 1 B [j = 0
i. coe 0 1 (j. B) (f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f
x))] (coe 0 i (j. B) (f.f x)))} j); k = 1 j. hcom 0 1 B [j = 0 i. hcom 0 i B [@2
= 1 i. coe 0 1 (j. B) (f.f x); @2 = 0 l. coe 0 1 (l. B) (f.f x)] (coe @2 1
(l. B) (hcom 1 0 B [@2 = 0 i. f.f x; @2 = 0 j. f.f x; @2 = 1 j. hcom 0 1 B [j =
0 i. coe 0 1 (j. B) (f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B)
(f.f x))] (coe 0 @2 (j. B) (f.f x)))); j = 1 i. coe @2 1 (l. B) (hcom 1 0 B [@2
= 0 i. f.f x; @2 = 0 j. f.f x; @2 = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B)
(f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))] (coe 0 @2
(j. B) (f.f x))); i = 1 i. coe 0 1 (j. B) (f.f x)] (coe i 1 (l. B) (hcom 1 0 B
[i = 0 i. f.f x; i = 0 j. f.f x; i = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B)
(f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))] (coe 0 i
(j. B) (f.f x))))] (coe i k (l. B) (hcom 1 0 B [i = 0 i. f.f x; i = 0 j. f.f x;
i = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B) (f.f x); j = 1 i. coe 0 1 (j. B)
(f.f x)] (coe 0 1 (j. B) (f.f x))] (coe 0 i (j. B) (f.f x)))))); k = 1 k. hcom 1
0 B [i = 0 i. f.f x; i = 0 j. f.f x; i = 1 j. hcom 0 1 B [j = 0 i. coe 0 1
(j. B) (f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))] (coe
0 i (j. B) (f.f x)); i = 0 i. f.f (hcom 0 i A [k = 0 k. hcom 0 1 A [k = 0
i. f.linv x {f.g (f.f x)} {x} i; k = 1 l. f.g (coe 1 0 (l. B) (coe 0 1 (l. B)
(f.f x)))] (f.g (coe k 0 (l. B) (hcom 1 0 B [k = 0 i. f.f x; k = 0 j. f.f x; k =
1 j. hcom 0 1 B [j = 0 i. coe 0 1 (l. B) (f.f x); j = 1 i. coe 0 1 (l. B) (f.f
x)] (coe 0 1 (l. B) (f.f x))] (coe 0 k (l. B) (f.f x))))); k = 1 k. x] x); i = 1
i. hcom 1 i B [k = 0 k. hcom 0 1 B [k = 1 i. coe 0 1 (j. B) (f.f x); k = 0
l. coe 0 1 (l. B) (f.f (f.g (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x)))))] (coe k
1 (l. B) (hcom 1 0 B [k = 1 i. coe 0 1 (j. B) (f.f x); k = 0 j. hcom 0 1 B [j =
0 i. f.f (f.g (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x)))); j = 1 i. coe 1 0
(l. B) (coe 0 1 (j. B) (f.f x))] (f.rinv (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f
x))) {f.f (f.g (coe 1 0 (l. B) (coe 0 1 (j. B) (f.f x))))} {coe 1 0 (l. B) (coe
0 1 (j. B) (f.f x))} j); k = 1 j. coe 0 1 (j. B) (f.f x)] (coe 1 k (l. B) (coe 0
1 (j. B) (f.f x))))); k = 1 k. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))]
(hcom 1 0 B [i = 0 i. f.f x; i = 0 j. f.f x; i = 1 j. hcom 0 1 B [j = 0 i. coe 0
1 (j. B) (f.f x); j = 1 i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))]
(coe 0 i (j. B) (f.f x))))); l = 1 i. hcom 0 1 B [i = 1 i. coe 0 1 (j. B) (f.f
x); i = 0 l. coe 0 1 (i. B) (f.f x)] (coe i 1 (i. B) (hcom 1 0 B [i = 0 i. f.f
x; i = 0 j. f.f x; i = 1 j. hcom 0 1 B [j = 0 i. coe 0 1 (j. B) (f.f x); j = 1
i. coe 0 1 (j. B) (f.f x)] (coe 0 1 (j. B) (f.f x))] (coe 0 i (j. B) (f.f x))))]
(coe 0 1 (i. B) (f.f x)));