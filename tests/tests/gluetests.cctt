
import basics;

coeIsEquiv' (A : I → U)(r r' : I) : isEquiv (A r) (A r') (λ x. coe r r' A x) :=
  let f'    (i : I)(x : A r)        : A i := coe r i A x;
  let g'    (i : I)(x : A i)        : A r := coe i r A x;
  let linv' (i : I)(x : A r)(j : I) : A r := hcom r i (A r) [j=0 k. x; j=1 k. coe k r A (coe r k A x)] x;
  let rinv' (i : I)(x : A i)(j : I) : A i := hcom i r (A i) [j=0 k. coe k i A (coe i k A x); j=1 k. x] x;

  ( λ x. g' r' x
  , λ x j. linv' r' x j
  , λ x j. rinv' r' x j
  , λ x l k. hcom r r' (A r')
                      [k=0 i. coe i r' A (f' i (linv' i x l))
                      ;k=1 i. coe i r' A (f' i x)
		      ;l=0 i. coe i r' A (f' i x)
		      ;l=1 i. coe i r' A (rinv' i (f' i x) k)]
		      (coe r r' A x)
  );


coeIsEquivNf (A : I → U)(r r' : I) : isEquiv (A r) (A r') (λ x. coe r r' A x) :=
(λ x. coe r' r A x, λ x {x} {coe r' r A (coe r r' A x)} j. hcom r r'
(A r) [j = 0 k. x; j = 1 k. coe k r A (coe r k A x)] x, λ x {coe r r' A (coe r'
r A x)} {x} j. hcom r' r (A r') [j = 0 k. coe k r' A (coe r' k A x); j = 1 k. x]
x, λ x {λ {coe r r' A x} {coe r r' A x} _. coe r r' A x} {λ {coe r r' A (coe r'
r A (coe r r' A x))} {coe r r' A x} j. hcom r' r (A r') [j = 0 k. coe k r' A
(coe r' k A (coe r r' A x)); j = 1 k. coe r r' A x] (coe r r' A x)} l {coe r r'
A (hcom r r' (A r) [l = 0 k. x; l = 1 k. coe k r A (coe r k A x)] x)} {coe r r'
A x} k. hcom r r' (A r') [k = 0 i. coe i r' A (coe r i A (hcom r i (A r) [l = 0
k1. x; l = 1 k1. coe k1 r A (coe r k1 A x)] x)); k = 1 i. coe i r' A (coe r i A
x); l = 0 i. coe i r' A (coe r i A x); l = 1 i. coe i r' A (hcom i r (A i) [k =
0 k1. coe k1 i A (coe i k1 A (coe r i A x)); k = 1 k1. coe r i A x] (coe r i A
x))] (coe r r' A x));



coeIsEquivNfOK (A : I → U)(r r' : I) : coeIsEquiv A r r' = coeIsEquivNf A r r' :=
  refl;

coeIsEquivNf'OK (A : I → U)(r r' : I) : coeIsEquiv' A r r' = coeIsEquivNf A r r' :=
  refl;

coe01isEquivNf (A : I → U) : isEquiv (A 0) (A 1)  (λ x. coe 0 1 A x) :=

 (λ x. coe 1 0 A x

, λ x {x} {coe 1 0 A (coe 0 1 A x)} j. hcom 0 1 (A 0) [j = 0 k. x; j = 1 k. coe k 0 A (coe 0 k A x)] x

, λ x {coe 0 1 A (coe 1 0 A x)} {x} j. hcom 1 0 (A 1) [j = 0 k. coe k 1 A (coe 1 k A x); j = 1 k. x] x

, λ x {λ {coe 0 1 A x} {coe 0 1 A x} _. coe 0 1 A x}
      {λ {coe 0 1 A (coe 1 0 A (coe 0 1 A x))} {coe 0 1 A x} j.
          hcom 1 0 (A 1) [j = 0 k. coe k 1 A (coe 1 k A (coe 0 1 A x))
	                ; j = 1 k. coe 0 1 A x] (coe 0 1 A x)}
      l
      {coe 0 1 A (hcom 0 1 (A 0) [l = 0 k. x; l = 1 k. coe k 0 A (coe 0 k A x)] x)}
      {coe 0 1 A x}
      k.
      hcom 0 1 (A 1) [k = 0 i. coe i 1 A (coe 0 i A (
                                   hcom 0 i (A 0) [l = 0 k1. x; l = 1 k1. coe k1 0 A (coe 0 k1 A x)] x))
                    ; k = 1 i. coe i 1 A (coe 0 i A x)
		    ; l = 0 i. coe i 1 A (coe 0 i A x)
		    ; l = 1 i. coe i 1 A (
		                   hcom i 0 (A i) [k = 0 k1. coe k1 i A (coe i k1 A (coe 0 i A x))
				                 ; k = 1 k1. coe 0 i A x] (coe 0 i A x))]
                    (coe 0 1 A x));

coe01isEquivNfOK (A : I → U) : coe01isEquivNf A = coeIsEquiv A 0 1 :=
  refl;

uabeta (A B : U)(f : equiv A B) : (λ x. coe 0 1 (ua A B f) x) ={_. A → B} f.1 :=
  λ i x. hcom 1 i [] (hcom i 1 [] (coe i 1 (i. B) (f.1 x)));

pathToEquiv (A B : U)(p : A = B) : equiv A B :=
  ((λ x. coe 0 1 p x), coeIsEquiv (λ i. p i) 0 1);

uaTrip (A B : U)(f : equiv A B) : equiv A B :=
  pathToEquiv A B (ua A B f);

uaTripNf (A B : U)(f : equiv A B) : equiv A B :=
(λ x. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x))), λ x. hcom
1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x))), λ x {x} {hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B)
(f.f x)))))))} j. hcom 0 1 A [j = 0 k. x; j = 1 k. hcom 1 0 A [k = 0 i. f.linv x
{x} {f.g (f.f x)} i] (f.g (hcom k 0 B [] (coe k 0 (l. B) (hcom 1 0 B [0 = k
i. f.f x; k = 0 j1. f.f x; k = 1 j1. hcom 1 0 B [j1 = 0 i. hcom 1 i B [] (hcom 0
1 B [] (coe 0 1 (l. B) (f.f x))); j1 = 1 i. hcom 0 1 B [] (coe 0 1 (l. B) (f.f
x))] (hcom 0 1 B [] (coe 0 1 (l. B) (f.f x)))] (hcom 0 k B [] (coe 0 k (l. B)
(f.f x)))))))] x, λ x {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f (hcom 1
0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))))))} {x} j. hcom 1 0 B [j = 0
k. hcom 1 0 B [k = 1 i. x] (hcom k 1 B [] (coe k 1 (l. B) (hcom 1 0 B [1 = k
i. x; k = 0 j1. hcom 1 0 B [j1 = 0 i. f.f (hcom 1 i A [] (f.g (hcom 1 0 B []
(coe 1 0 (l. B) x)))); j1 = 1 i. hcom 1 0 B [] (coe 1 0 (l. B) x)] (f.rinv (hcom
1 0 B [] (coe 1 0 (l. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (l. B) x)))}
{hcom 1 0 B [] (coe 1 0 (l. B) x)} j1); k = 1 j1. x] (hcom 1 k B [] (coe 1 k
(l. B) x))))); j = 1 k. x] x, λ x {λ {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1
(i. B) (f.f x)))} {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))}
_. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))} {λ {hcom 1 0 B []
(hcom 0 1 B [] (coe 0 1 (i. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))))))))))} {hcom 1
0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))} j. hcom 1 0 B [j = 0 k. hcom 1
0 B [k = 1 i. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.f x)))] (hcom k 1
B [] (coe k 1 (l. B) (hcom 1 0 B [1 = k i. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1
(i1. B) (f.f x))); k = 0 j1. hcom 1 0 B [j1 = 0 i. f.f (hcom 1 i A [] (f.g (hcom
1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i1. B) (f.f
x)))))))); j1 = 1 i. hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B []
(coe 0 1 (i1. B) (f.f x)))))] (f.rinv (hcom 1 0 B [] (coe 1 0 (l. B) (hcom 1 0 B
[] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))))) {f.f (f.g (hcom 1 0 B [] (coe 1 0
(l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))))))} {hcom 1 0 B
[] (coe 1 0 (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))))}
j1); k = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))] (hcom 1 k
B [] (coe 1 k (l. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f
x))))))))); j = 1 k. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))]
(hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B) (f.f x))))} l {hcom 1 0 B [] (hcom
0 1 B [] (coe 0 1 (i. B) (f.f (hcom 0 1 A [l = 0 k. x; l = 1 k. hcom 1 0 A [k =
0 i. f.linv x {x} {f.g (f.f x)} i] (f.g (hcom k 0 B [] (coe k 0 (l1. B) (hcom 1
0 B [0 = k i. f.f x; k = 0 j. f.f x; k = 1 j. hcom 1 0 B [j = 0 i. hcom 1 i B []
(hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j = 1 i. hcom 0 1 B [] (coe 0 1
(l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x)))] (hcom 0 k B [] (coe
0 k (l1. B) (f.f x)))))))] x))))} {hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (i. B)
(f.f x)))} k. hcom 0 1 B [k = 0 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [] (hcom 0 1
B [] (coe 0 1 (j. B) (f.f (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0
i2. f.linv x {x} {f.g (f.f x)} i2] (f.g (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom
1 0 B [0 = k1 i2. f.f x; k1 = 0 j. f.f x; k1 = 1 j. hcom 1 0 B [j = 0 i2. hcom 1
i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j = 1 i2. hcom 0 1 B [] (coe
0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x)))] (hcom 0 k1 B []
(coe 0 k1 (l1. B) (f.f x)))))))] x))))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom 1
0 B [0 = i i1. f.f x; i = 0 j. f.f x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B
[] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom
1 0 A [k1 = 0 i2. f.linv x {x} {f.g (f.f x)} i2] (f.g (hcom k1 0 B [] (coe k1 0
(l1. B) (hcom 1 0 B [0 = k1 i2. f.f x; k1 = 0 j1. f.f x; k1 = 1 j1. hcom 1 0 B
[j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j1 = 1
i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B)
(f.f x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f x)))))))] x)))); j = 1
i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.f (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom
1 0 A [k1 = 0 i2. f.linv x {x} {f.g (f.f x)} i2] (f.g (hcom k1 0 B [] (coe k1 0
(l1. B) (hcom 1 0 B [0 = k1 i2. f.f x; k1 = 0 j1. f.f x; k1 = 1 j1. hcom 1 0 B
[j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j1 = 1
i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B)
(f.f x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f x)))))))] x)))] (hcom 0 1 B []
(coe 0 1 (j1. B) (f.f (hcom 0 1 A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0
i1. f.linv x {x} {f.g (f.f x)} i1] (f.g (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom
1 0 B [0 = k1 i1. f.f x; k1 = 0 j1. f.f x; k1 = 1 j1. hcom 1 0 B [j1 = 0
i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j1 = 1 i1. hcom 0
1 B [] (coe 0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x)))]
(hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f x)))))))] x))))] (hcom 0 i B [] (coe 0 i
(j. B) (f.f (hcom 0 i A [l = 0 k1. x; l = 1 k1. hcom 1 0 A [k1 = 0 i1. f.linv x
{x} {f.g (f.f x)} i1] (f.g (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1
i1. f.f x; k1 = 0 j. f.f x; k1 = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom
0 1 B [] (coe 0 1 (l1. B) (f.f x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B)
(f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x)))] (hcom 0 k1 B [] (coe 0 k1
(l1. B) (f.f x)))))))] x))))))); k = 1 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B []
(hcom 0 1 B [] (coe 0 1 (j. B) (f.f x)))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom
1 0 B [0 = i i1. f.f x; i = 0 j. f.f x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1
B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x))); j = 1 i1. hcom 0 1 B [] (coe 0 1
(j1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))] (hcom 0 i B [] (coe
0 i (j. B) (f.f x)))))); l = 0 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [] (hcom 0 1
B [] (coe 0 1 (j. B) (f.f x)))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom 1 0 B [0 =
i i1. f.f x; i = 0 j. f.f x; i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom
0 1 B [] (coe 0 1 (j1. B) (f.f x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B)
(f.f x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))] (hcom 0 i B [] (coe 0 i
(j. B) (f.f x)))))); l = 1 i. hcom 1 0 B [i = 1 i1. hcom 1 0 B [k = 0 k1. hcom 1
0 B [k1 = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.f x)))] (hcom k1
1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom 0 1 B []
(coe 0 1 (j. B) (f.f x))); k1 = 0 j. hcom 1 0 B [j = 0 i2. f.f (hcom 1 i2 A []
(f.g (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1
(j1. B) (f.f x)))))))); j = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B []
(hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))))] (f.rinv (hcom 1 0 B [] (coe 1 0
(l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))))) {f.f (f.g
(hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B)
(f.f x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B []
(coe 0 1 (j1. B) (f.f x)))))} j); k1 = 1 j. hcom 1 0 B [] (hcom 0 1 B [] (coe 0
1 (j1. B) (f.f x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1
B [] (coe 0 1 (j. B) (f.f x))))))))); k = 1 k1. hcom 1 0 B [] (hcom 0 1 B []
(coe 0 1 (j. B) (f.f x)))] (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.f
x))))] (hcom i 1 B [] (coe i 1 (i1. B) (hcom i 0 B [k = 0 k1. hcom 1 0 B [k1 = i
i1. hcom 1 0 B [0 = i i2. f.f x; i = 0 j. f.f x; i = 1 j. hcom 1 0 B [j = 0
i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x))); j = 1 i2. hcom 0 1
B [] (coe 0 1 (j1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))] (hcom
0 i B [] (coe 0 i (j. B) (f.f x))); i = 0 j. hcom 1 0 B [j = 0 i1. f.f (hcom 1
i1 A [k1 = 0 i2. f.linv x {x} {f.g (f.f x)} i2] (f.g (hcom k1 0 B [] (coe k1 0
(l1. B) (hcom 1 0 B [0 = k1 i2. f.f x; k1 = 0 j1. f.f x; k1 = 1 j1. hcom 1 0 B
[j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j1 = 1
i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B)
(f.f x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f x)))))))); j = 1 i1. hcom k1 0
B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.f x; k1 = 0 j1. f.f x; k1 = 1
j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f
x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0
1 (l1. B) (f.f x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f x))))); k1 = 0
i1. f.coh x {λ {f.f x} {f.f x} _. f.f x} {f.rinv (f.f x)} i1 {f.f (f.linv x {x}
{f.g (f.f x)} i1)} {f.f x} j] (f.rinv (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1
0 B [0 = k1 i1. f.f x; k1 = 0 j1. f.f x; k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom
1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j1 = 1 i1. hcom 0 1 B []
(coe 0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x)))] (hcom 0 k1
B [] (coe 0 k1 (l1. B) (f.f x)))))) {f.f (f.g (hcom k1 0 B [] (coe k1 0 (l1. B)
(hcom 1 0 B [0 = k1 i1. f.f x; k1 = 0 j1. f.f x; k1 = 1 j1. hcom 1 0 B [j1 = 0
i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j1 = 1 i1. hcom 0
1 B [] (coe 0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x)))]
(hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f x)))))))} {hcom k1 0 B [] (coe k1 0
(l1. B) (hcom 1 0 B [0 = k1 i1. f.f x; k1 = 0 j1. f.f x; k1 = 1 j1. hcom 1 0 B
[j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j1 = 1
i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B)
(f.f x)))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f x)))))} j); i = 1 j. hcom 1 0
B [j = 0 i1. hcom 1 i1 B [k1 = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1
(j1. B) (f.f x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1
i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x))); k1 = 0 j1. hcom 1 0
B [j1 = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0
B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))))))); j1 = 1 i2. hcom 1 0 B []
(coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))))]
(f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1
(j2. B) (f.f x)))))) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B []
(hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B)
(hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))))} j1); k1 = 1 j1. hcom
1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))] (hcom 1 k1 B [] (coe 1 k1
(l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x))))))))); j = 1
i1. hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom 1 0 B [] (hcom
0 1 B [] (coe 0 1 (j1. B) (f.f x))); k1 = 0 j1. hcom 1 0 B [j1 = 0 i2. f.f (hcom
1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B []
(coe 0 1 (j2. B) (f.f x)))))))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom
1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))))] (f.rinv (hcom 1 0 B []
(coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x))))))
{f.f (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1
(j2. B) (f.f x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1
B [] (coe 0 1 (j2. B) (f.f x)))))} j1); k1 = 1 j1. hcom 1 0 B [] (hcom 0 1 B []
(coe 0 1 (j2. B) (f.f x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B []
(hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))))))); k1 = 1 i1. hcom 1 0 B [] (hcom 0
1 B [] (coe 0 1 (j1. B) (f.f x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B
[1 = k1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x))); k1 = 0
j1. hcom 1 0 B [j1 = 0 i1. f.f (hcom 1 i1 A [] (f.g (hcom 1 0 B [] (coe 1 0
(l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))))))); j1 = 1
i1. hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1
(j2. B) (f.f x)))))] (f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B []
(hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))))) {f.f (f.g (hcom 1 0 B [] (coe 1 0
(l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))))))} {hcom 1 0
B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f
x)))))} j1); k1 = 1 j1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))]
(hcom 1 k1 B [] (coe 1 k1 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B)
(f.f x)))))))))] (hcom k1 i B [] (coe k1 i (l1. B) (hcom 1 0 B [i = k1 i1. hcom
1 0 B [0 = i i2. f.f x; i = 0 j. f.f x; i = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2
B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x))); j = 1 i2. hcom 0 1 B [] (coe 0 1
(j1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))] (hcom 0 i B [] (coe
0 i (j. B) (f.f x))); k1 = 0 j. hcom 1 0 B [j = 0 i1. f.f (hcom 1 i1 A [i = 0
i2. f.linv x {x} {f.g (f.f x)} i2] (f.g (hcom i 0 B [] (coe i 0 (l1. B) (hcom 1
0 B [0 = i i2. f.f x; i = 0 j1. f.f x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1
i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x))); j1 = 1 i2. hcom 0 1 B [] (coe
0 1 (j2. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))] (hcom 0 i B []
(coe 0 i (j1. B) (f.f x)))))))); j = 1 i1. hcom i 0 B [] (coe i 0 (l1. B) (hcom
1 0 B [0 = i i2. f.f x; i = 0 j1. f.f x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1
i2 B [] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x))); j1 = 1 i2. hcom 0 1 B [] (coe
0 1 (j2. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))] (hcom 0 i B []
(coe 0 i (j1. B) (f.f x))))); i = 0 i1. f.coh x {λ {f.f x} {f.f x} _. f.f x}
{f.rinv (f.f x)} i1 {f.f (f.linv x {x} {f.g (f.f x)} i1)} {f.f x} j] (f.rinv
(hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i1. f.f x; i = 0 j1. f.f x; i
= 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B)
(f.f x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x))] (hcom 0 1 B []
(coe 0 1 (j2. B) (f.f x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.f x)))))) {f.f
(f.g (hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i1. f.f x; i = 0 j1. f.f
x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1
(j2. B) (f.f x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x))] (hcom 0 1
B [] (coe 0 1 (j2. B) (f.f x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.f x)))))))}
{hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [0 = i i1. f.f x; i = 0 j1. f.f x; i
= 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j2. B)
(f.f x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x))] (hcom 0 1 B []
(coe 0 1 (j2. B) (f.f x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.f x)))))} j); k1
= 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [i = 1 i2. hcom 1 0 B [] (hcom 0 1 B []
(coe 0 1 (j1. B) (f.f x)))] (hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [0 = i
i2. f.f x; i = 0 j1. f.f x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B []
(hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1
(j2. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))] (hcom 0 i B [] (coe
0 i (j1. B) (f.f x)))))); j = 1 i1. hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B
[0 = i i2. f.f x; i = 0 j1. f.f x; i = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B
[] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1
(j2. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x)))] (hcom 0 i B [] (coe
0 i (j1. B) (f.f x))))); i = 1 i1. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B)
(f.f x)))] (hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [0 = i i1. f.f x; i = 0
j1. f.f x; i = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0
1 (j2. B) (f.f x))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (j2. B) (f.f x))] (hcom 0
1 B [] (coe 0 1 (j2. B) (f.f x)))] (hcom 0 i B [] (coe 0 i (j1. B) (f.f x))))))]
(hcom i k1 B [] (coe i k1 (l1. B) (hcom 1 0 B [0 = i i1. f.f x; i = 0 j. f.f x;
i = 1 j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B)
(f.f x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x))] (hcom 0 1 B []
(coe 0 1 (j1. B) (f.f x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.f x))))))))); k =
1 k1. hcom 1 0 B [0 = i i1. f.f x; i = 0 j. f.f x; i = 1 j. hcom 1 0 B [j = 0
i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x))); j = 1 i1. hcom 0 1
B [] (coe 0 1 (j1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))] (hcom
0 i B [] (coe 0 i (j. B) (f.f x))); i = 0 i1. f.f (hcom 0 i1 A [k = 0 k1. hcom 1
0 A [k1 = 0 i2. f.linv x {x} {f.g (f.f x)} i2] (f.g (hcom k1 0 B [] (coe k1 0
(l1. B) (hcom 1 0 B [0 = k1 i2. f.f x; k1 = 0 j. f.f x; k1 = 1 j. hcom 1 0 B [j
= 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x))); j = 1 i2. hcom
0 1 B [] (coe 0 1 (l1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f x)))]
(hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f x))))))); k = 1 k1. x] x); i = 1 i1. hcom
1 i1 B [k = 0 k1. hcom 1 0 B [k1 = 1 i2. hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1
(j. B) (f.f x)))] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. hcom
1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.f x))); k1 = 0 j. hcom 1 0 B [j = 0
i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B []
(hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))))))); j = 1 i2. hcom 1 0 B [] (coe 1 0
(l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))))] (f.rinv
(hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j1. B)
(f.f x)))))) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B [] (hcom 0 1
B [] (coe 0 1 (j1. B) (f.f x)))))))} {hcom 1 0 B [] (coe 1 0 (l1. B) (hcom 1 0 B
[] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))))} j); k1 = 1 j. hcom 1 0 B []
(hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x)))] (hcom 1 k1 B [] (coe 1 k1 (l1. B)
(hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.f x))))))))); k = 1 k1. hcom 1
0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.f x)))] (hcom 1 0 B [] (hcom 0 1 B []
(coe 0 1 (j. B) (f.f x))))] (hcom 1 0 B [0 = i i1. f.f x; i = 0 j. f.f x; i = 1
j. hcom 1 0 B [j = 0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (j1. B) (f.f
x))); j = 1 i1. hcom 0 1 B [] (coe 0 1 (j1. B) (f.f x))] (hcom 0 1 B [] (coe 0 1
(j1. B) (f.f x)))] (hcom 0 i B [] (coe 0 i (j. B) (f.f x)))))))] (hcom 1 0 B []
(hcom 0 1 B [] (coe 0 1 (i. B) (f.f x)))));


uaTripNfOK (A B : U)(f : equiv A B) : uaTrip A B f ={_. equiv A B} uaTripNf A B f :=
  refl;

pathToEquiv' (A B : U)(p : A = B) : equiv B A :=
  (λ x. coe 1 0 p x, coeIsEquiv (λ i. p i) 1 0);

uaTrip' (A B : U)(f : equiv A B) : equiv B A :=
  pathToEquiv' A B (ua A B f);

uaTripNf' (A B : U)(f : equiv A B) : equiv B A :=
(λ x. hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i. B) x))), λ x. hcom
1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.f x))), λ x {x} {hcom 1 0 B [] (hcom
0 1 B [] (coe 0 1 (j. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i. B)
x)))))))} j. hcom 1 0 B [j = 0 k. x; j = 1 k. hcom 1 0 B [k = 1 i. x] (hcom k 1
B [] (coe k 1 (l. B) (hcom 1 0 B [1 = k i. x; k = 0 j1. hcom 1 0 B [j1 = 0
i. f.f (hcom 1 i A [] (f.g (hcom 1 0 B [] (coe 1 0 (l. B) x)))); j1 = 1 i. hcom
1 0 B [] (coe 1 0 (l. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (l. B) x)) {f.f
(f.g (hcom 1 0 B [] (coe 1 0 (l. B) x)))} {hcom 1 0 B [] (coe 1 0 (l. B) x)}
j1); k = 1 j1. x] (hcom 1 k B [] (coe 1 k (l. B) x)))))] x, λ x {hcom 1 0 A []
(f.g (hcom 1 0 B [] (coe 1 0 (i. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1
(j. B) (f.f x)))))))} {x} j. hcom 0 1 A [j = 0 k. hcom 1 0 A [k = 0 i. f.linv x
{x} {f.g (f.f x)} i] (f.g (hcom k 0 B [] (coe k 0 (l. B) (hcom 1 0 B [0 = k
i. f.f x; k = 0 j1. f.f x; k = 1 j1. hcom 1 0 B [j1 = 0 i. hcom 1 i B [] (hcom 0
1 B [] (coe 0 1 (l. B) (f.f x))); j1 = 1 i. hcom 0 1 B [] (coe 0 1 (l. B) (f.f
x))] (hcom 0 1 B [] (coe 0 1 (l. B) (f.f x)))] (hcom 0 k B [] (coe 0 k (l. B)
(f.f x))))))); j = 1 k. x] x, λ x {λ {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(i. B) x)))} {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i. B) x)))} _. hcom 1
0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i. B) x)))} {λ {hcom 1 0 A [] (f.g (hcom 1
0 B [] (coe 1 0 (i. B) (hcom 1 0 B [] (hcom 0 1 B [] (coe 0 1 (j. B) (f.f (hcom
1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i. B) x)))))))))))} {hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (i. B) x)))} j. hcom 0 1 A [j = 0 k. hcom 1 0 A [k = 0
i. f.linv (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i1. B) x)))) {hcom 1 0 A
[] (f.g (hcom 1 0 B [] (coe 1 0 (i1. B) x)))} {f.g (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (i1. B) x)))))} i] (f.g (hcom k 0 B [] (coe k 0 (l. B)
(hcom 1 0 B [0 = k i. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i1. B)
x)))); k = 0 j1. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i. B) x)))); k
= 1 j1. hcom 1 0 B [j1 = 0 i. hcom 1 i B [] (hcom 0 1 B [] (coe 0 1 (l. B) (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i1. B) x))))))); j1 = 1 i. hcom 0 1
B [] (coe 0 1 (l. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i1. B)
x))))))] (hcom 0 1 B [] (coe 0 1 (l. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B []
(coe 1 0 (i. B) x)))))))] (hcom 0 k B [] (coe 0 k (l. B) (f.f (hcom 1 0 A []
(f.g (hcom 1 0 B [] (coe 1 0 (i. B) x))))))))))); j = 1 k. hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (i. B) x)))] (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(i. B) x))))} l {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i. B) (hcom 1 0 B
[l = 0 k. x; l = 1 k. hcom 1 0 B [k = 1 i. x] (hcom k 1 B [] (coe k 1 (l1. B)
(hcom 1 0 B [1 = k i. x; k = 0 j. hcom 1 0 B [j = 0 i. f.f (hcom 1 i A [] (f.g
(hcom 1 0 B [] (coe 1 0 (l1. B) x)))); j = 1 i. hcom 1 0 B [] (coe 1 0 (l1. B)
x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1
0 (l1. B) x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j); k = 1 j. x] (hcom 1 k B
[] (coe 1 k (l1. B) x)))))] x))))} {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(i. B) x)))} k. hcom 1 0 A [k = 0 i. hcom 1 0 A [i = 0 i1. f.linv (hcom 1 0 A []
(f.g (hcom 1 0 B [] (coe 1 0 (j. B) (hcom 1 0 B [l = 0 k1. x; l = 1 k1. hcom 1 0
B [k1 = 1 i2. x] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. x; k1
= 0 j. hcom 1 0 B [j = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0
(l1. B) x)))); j = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) x)] (f.rinv (hcom 1 0 B
[] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))} {hcom 1
0 B [] (coe 1 0 (l1. B) x)} j); k1 = 1 j. x] (hcom 1 k1 B [] (coe 1 k1 (l1. B)
x)))))] x))))) {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) (hcom 1 0 B [l
= 0 k1. x; l = 1 k1. hcom 1 0 B [k1 = 1 i2. x] (hcom k1 1 B [] (coe k1 1 (l1. B)
(hcom 1 0 B [1 = k1 i2. x; k1 = 0 j. hcom 1 0 B [j = 0 i2. f.f (hcom 1 i2 A []
(f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))); j = 1 i2. hcom 1 0 B [] (coe 1 0
(l1. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B []
(coe 1 0 (l1. B) x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j); k1 = 1 j. x]
(hcom 1 k1 B [] (coe 1 k1 (l1. B) x)))))] x))))} {f.g (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j. B) (hcom 1 0 B [l = 0 k1. x; l = 1 k1. hcom 1 0 B
[k1 = 1 i2. x] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. x; k1 =
0 j. hcom 1 0 B [j = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0
(l1. B) x)))); j = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) x)] (f.rinv (hcom 1 0 B
[] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))} {hcom 1
0 B [] (coe 1 0 (l1. B) x)} j); k1 = 1 j. x] (hcom 1 k1 B [] (coe 1 k1 (l1. B)
x)))))] x))))))} i1] (f.g (hcom i 0 B [] (coe i 0 (i1. B) (hcom 1 0 B [1 = i
i1. x; i = 0 j. hcom 1 0 B [j = 0 i1. f.f (hcom 1 i1 A [] (f.g (hcom 1 0 B []
(coe 1 0 (j1. B) (hcom 1 0 B [l = 0 k1. x; l = 1 k1. hcom 1 0 B [k1 = 1 i2. x]
(hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i2. x; k1 = 0 j1. hcom 1 0
B [j1 = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))); j1
= 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0
(l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))} {hcom 1 0 B [] (coe
1 0 (l1. B) x)} j1); k1 = 1 j1. x] (hcom 1 k1 B [] (coe 1 k1 (l1. B) x)))))]
x))))); j = 1 i1. hcom 1 0 B [] (coe 1 0 (j1. B) (hcom 1 0 B [l = 0 k1. x; l = 1
k1. hcom 1 0 B [k1 = 1 i2. x] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 =
k1 i2. x; k1 = 0 j1. hcom 1 0 B [j1 = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B
[] (coe 1 0 (l1. B) x)))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) x)] (f.rinv
(hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (l1. B)
x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j1); k1 = 1 j1. x] (hcom 1 k1 B []
(coe 1 k1 (l1. B) x)))))] x))] (f.rinv (hcom 1 0 B [] (coe 1 0 (j1. B) (hcom 1 0
B [l = 0 k1. x; l = 1 k1. hcom 1 0 B [k1 = 1 i1. x] (hcom k1 1 B [] (coe k1 1
(l1. B) (hcom 1 0 B [1 = k1 i1. x; k1 = 0 j1. hcom 1 0 B [j1 = 0 i1. f.f (hcom 1
i1 A [] (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))); j1 = 1 i1. hcom 1 0 B []
(coe 1 0 (l1. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom
1 0 B [] (coe 1 0 (l1. B) x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j1); k1 = 1
j1. x] (hcom 1 k1 B [] (coe 1 k1 (l1. B) x)))))] x))) {f.f (f.g (hcom 1 0 B []
(coe 1 0 (j1. B) (hcom 1 0 B [l = 0 k1. x; l = 1 k1. hcom 1 0 B [k1 = 1 i1. x]
(hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i1. x; k1 = 0 j1. hcom 1 0
B [j1 = 0 i1. f.f (hcom 1 i1 A [] (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))); j1
= 1 i1. hcom 1 0 B [] (coe 1 0 (l1. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0
(l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))} {hcom 1 0 B [] (coe
1 0 (l1. B) x)} j1); k1 = 1 j1. x] (hcom 1 k1 B [] (coe 1 k1 (l1. B) x)))))]
x))))} {hcom 1 0 B [] (coe 1 0 (j1. B) (hcom 1 0 B [l = 0 k1. x; l = 1 k1. hcom
1 0 B [k1 = 1 i1. x] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1 = k1
i1. x; k1 = 0 j1. hcom 1 0 B [j1 = 0 i1. f.f (hcom 1 i1 A [] (f.g (hcom 1 0 B []
(coe 1 0 (l1. B) x)))); j1 = 1 i1. hcom 1 0 B [] (coe 1 0 (l1. B) x)] (f.rinv
(hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (l1. B)
x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j1); k1 = 1 j1. x] (hcom 1 k1 B []
(coe 1 k1 (l1. B) x)))))] x))} j); i = 1 j. x] (hcom 1 i B [] (coe 1 i (j. B)
(hcom 1 i B [l = 0 k1. x; l = 1 k1. hcom 1 0 B [k1 = 1 i1. x] (hcom k1 1 B []
(coe k1 1 (l1. B) (hcom 1 0 B [1 = k1 i1. x; k1 = 0 j. hcom 1 0 B [j = 0 i1. f.f
(hcom 1 i1 A [] (f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))); j = 1 i1. hcom 1 0 B
[] (coe 1 0 (l1. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g
(hcom 1 0 B [] (coe 1 0 (l1. B) x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j); k1
= 1 j. x] (hcom 1 k1 B [] (coe 1 k1 (l1. B) x)))))] x))))))); k = 1 i. hcom 1 0
A [i = 0 i1. f.linv (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x))))
{hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))} {f.g (f.f (hcom 1 0 A
[] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))))} i1] (f.g (hcom i 0 B [] (coe i 0
(i1. B) (hcom 1 0 B [1 = i i1. x; i = 0 j. hcom 1 0 B [j = 0 i1. f.f (hcom 1 i1
A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))); j = 1 i1. hcom 1 0 B [] (coe 1
0 (j1. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (j1. B) x)) {f.f (f.g (hcom 1 0 B
[] (coe 1 0 (j1. B) x)))} {hcom 1 0 B [] (coe 1 0 (j1. B) x)} j); i = 1 j. x]
(hcom 1 i B [] (coe 1 i (j. B) x)))))); l = 0 i. hcom 1 0 A [i = 0 i1. f.linv
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))) {hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j. B) x)))} {f.g (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B
[] (coe 1 0 (j. B) x)))))} i1] (f.g (hcom i 0 B [] (coe i 0 (i1. B) (hcom 1 0 B
[1 = i i1. x; i = 0 j. hcom 1 0 B [j = 0 i1. f.f (hcom 1 i1 A [] (f.g (hcom 1 0
B [] (coe 1 0 (j1. B) x)))); j = 1 i1. hcom 1 0 B [] (coe 1 0 (j1. B) x)]
(f.rinv (hcom 1 0 B [] (coe 1 0 (j1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0
(j1. B) x)))} {hcom 1 0 B [] (coe 1 0 (j1. B) x)} j); i = 1 j. x] (hcom 1 i B []
(coe 1 i (j. B) x)))))); l = 1 i. hcom 1 0 A [i = 0 i1. f.linv (hcom 0 1 A [k =
0 k1. hcom 1 0 A [k1 = 0 i2. f.linv (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j. B) x)))) {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))} {f.g (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))))} i2] (f.g (hcom k1 0 B
[] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B
[] (coe 1 0 (j. B) x)))); k1 = 0 j. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe
1 0 (j1. B) x)))); k1 = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B []
(coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B)
x))))))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j1. B) x))))))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))))))] (hcom 0 k1 B []
(coe 0 k1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B)
x))))))))))); k = 1 k1. hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))]
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x))))) {hcom 0 1 A [k = 0
k1. hcom 1 0 A [k1 = 0 i2. f.linv (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j. B) x)))) {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))} {f.g (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))))} i2] (f.g (hcom k1 0 B
[] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B
[] (coe 1 0 (j. B) x)))); k1 = 0 j. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe
1 0 (j1. B) x)))); k1 = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B []
(coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B)
x))))))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j1. B) x))))))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))))))] (hcom 0 k1 B []
(coe 0 k1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B)
x))))))))))); k = 1 k1. hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))]
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x))))} {f.g (f.f (hcom 0 1 A
[k = 0 k1. hcom 1 0 A [k1 = 0 i2. f.linv (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe
1 0 (j. B) x)))) {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))} {f.g
(f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))))} i2] (f.g (hcom
k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j. B) x)))); k1 = 0 j. f.f (hcom 1 0 A [] (f.g (hcom 1
0 B [] (coe 1 0 (j1. B) x)))); k1 = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B []
(hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j1. B) x))))))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A []
(f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x))))))] (hcom 0 1 B [] (coe 0 1 (l1. B)
(f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))))))] (hcom 0 k1 B
[] (coe 0 k1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B)
x))))))))))); k = 1 k1. hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))]
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x))))))} i1] (f.g (hcom i 0 B
[] (coe i 0 (i1. B) (hcom i 1 B [k = 0 k1. hcom 1 0 B [k1 = i i1. hcom 1 0 B [1
= i i2. x; i = 0 j. hcom 1 0 B [j = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B
[] (coe 1 0 (j1. B) x)))); j = 1 i2. hcom 1 0 B [] (coe 1 0 (j1. B) x)] (f.rinv
(hcom 1 0 B [] (coe 1 0 (j1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (j1. B)
x)))} {hcom 1 0 B [] (coe 1 0 (j1. B) x)} j); i = 1 j. x] (hcom 1 i B [] (coe 1
i (j. B) x)); i = 0 j. hcom 1 0 B [j = 0 i1. f.f (hcom 1 i1 A [k1 = 0 i2. f.linv
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))) {hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j1. B) x)))} {f.g (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B
[] (coe 1 0 (j1. B) x)))))} i2] (f.g (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0
B [0 = k1 i2. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))); k1
= 0 j1. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))); k1 = 1
j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x))))))); j1 = 1 i2. hcom 0
1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B)
x))))))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B []
(coe 1 0 (j2. B) x)))))))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f (hcom 1 0 A []
(f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))))))))))); j = 1 i1. hcom k1 0 B []
(coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B []
(coe 1 0 (j1. B) x)))); k1 = 0 j1. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1
0 (j2. B) x)))); k1 = 1 j1. hcom 1 0 B [j1 = 0 i2. hcom 1 i2 B [] (hcom 0 1 B []
(coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B)
x))))))); j1 = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j2. B) x))))))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))))))] (hcom 0 k1 B []
(coe 0 k1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B)
x))))))))); k1 = 0 i1. f.coh (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B)
x)))) {λ {f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x))))} {f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x))))} _. f.f (hcom 1 0 A []
(f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x))))} {f.rinv (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j1. B) x)))))} i1 {f.f (f.linv (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j1. B) x)))) {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1
0 (j1. B) x)))} {f.g (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B)
x)))))} i1)} {f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x))))} j]
(f.rinv (hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.f (hcom 1 0
A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))); k1 = 0 j1. f.f (hcom 1 0 A []
(f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))); k1 = 1 j1. hcom 1 0 B [j1 = 0
i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j2. B) x))))))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1
(l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x))))))] (hcom
0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j2. B) x)))))))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j1. B) x)))))))))) {f.f (f.g (hcom k1 0 B [] (coe k1 0
(l1. B) (hcom 1 0 B [0 = k1 i1. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j1. B) x)))); k1 = 0 j1. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j2. B) x)))); k1 = 1 j1. hcom 1 0 B [j1 = 0 i1. hcom 1 i1 B [] (hcom 0 1 B []
(coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B)
x))))))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j2. B) x))))))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))))))] (hcom 0 k1 B []
(coe 0 k1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B)
x)))))))))))} {hcom k1 0 B [] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i1. f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))); k1 = 0 j1. f.f (hcom
1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))); k1 = 1 j1. hcom 1 0 B [j1 =
0 i1. hcom 1 i1 B [] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j2. B) x))))))); j1 = 1 i1. hcom 0 1 B [] (coe 0 1
(l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x))))))] (hcom
0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j2. B) x)))))))] (hcom 0 k1 B [] (coe 0 k1 (l1. B) (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j1. B) x)))))))))} j); i = 1 j. hcom 1 0 B [j = 0
i1. hcom 1 i1 B [k1 = 1 i2. x] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0 B [1
= k1 i2. x; k1 = 0 j1. hcom 1 0 B [j1 = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0
B [] (coe 1 0 (l1. B) x)))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) x)]
(f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0
(l1. B) x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j1); k1 = 1 j1. x] (hcom 1 k1
B [] (coe 1 k1 (l1. B) x))))); j = 1 i1. hcom k1 1 B [] (coe k1 1 (l1. B) (hcom
1 0 B [1 = k1 i2. x; k1 = 0 j1. hcom 1 0 B [j1 = 0 i2. f.f (hcom 1 i2 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (l1. B) x)))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B)
x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1
0 (l1. B) x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j1); k1 = 1 j1. x] (hcom 1
k1 B [] (coe 1 k1 (l1. B) x)))); k1 = 1 i1. x] (hcom k1 1 B [] (coe k1 1 (l1. B)
(hcom 1 0 B [1 = k1 i1. x; k1 = 0 j1. hcom 1 0 B [j1 = 0 i1. f.f (hcom 1 i1 A []
(f.g (hcom 1 0 B [] (coe 1 0 (l1. B) x)))); j1 = 1 i1. hcom 1 0 B [] (coe 1 0
(l1. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B []
(coe 1 0 (l1. B) x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j1); k1 = 1 j1. x]
(hcom 1 k1 B [] (coe 1 k1 (l1. B) x)))))] (hcom k1 i B [] (coe k1 i (l1. B)
(hcom 1 0 B [i = k1 i1. hcom 1 0 B [1 = i i2. x; i = 0 j. hcom 1 0 B [j = 0
i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))); j = 1
i2. hcom 1 0 B [] (coe 1 0 (j1. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (j1. B)
x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))} {hcom 1 0 B [] (coe 1 0
(j1. B) x)} j); i = 1 j. x] (hcom 1 i B [] (coe 1 i (j. B) x)); k1 = 0 j. hcom 1
0 B [j = 0 i1. f.f (hcom 1 i1 A [i = 0 i2. f.linv (hcom 1 0 A [] (f.g (hcom 1 0
B [] (coe 1 0 (j1. B) x)))) {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B)
x)))} {f.g (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))))} i2]
(f.g (hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [1 = i i2. x; i = 0 j1. hcom 1
0 B [j1 = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x))));
j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (j2. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0
(j2. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))} {hcom 1 0 B [] (coe
1 0 (j2. B) x)} j1); i = 1 j1. x] (hcom 1 i B [] (coe 1 i (j1. B) x))))))); j =
1 i1. hcom i 0 B [] (coe i 0 (l1. B) (hcom 1 0 B [1 = i i2. x; i = 0 j1. hcom 1
0 B [j1 = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x))));
j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (j2. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0
(j2. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))} {hcom 1 0 B [] (coe
1 0 (j2. B) x)} j1); i = 1 j1. x] (hcom 1 i B [] (coe 1 i (j1. B) x)))); i = 0
i1. f.coh (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))) {λ {f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x))))} {f.f (hcom 1 0 A []
(f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x))))} _. f.f (hcom 1 0 A [] (f.g (hcom 1 0
B [] (coe 1 0 (j1. B) x))))} {f.rinv (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B []
(coe 1 0 (j1. B) x)))))} i1 {f.f (f.linv (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe
1 0 (j1. B) x)))) {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))} {f.g
(f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))))} i1)} {f.f (hcom
1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x))))} j] (f.rinv (hcom i 0 B []
(coe i 0 (l1. B) (hcom 1 0 B [1 = i i1. x; i = 0 j1. hcom 1 0 B [j1 = 0 i1. f.f
(hcom 1 i1 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))); j1 = 1 i1. hcom 1 0
B [] (coe 1 0 (j2. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (j2. B) x)) {f.f (f.g
(hcom 1 0 B [] (coe 1 0 (j2. B) x)))} {hcom 1 0 B [] (coe 1 0 (j2. B) x)} j1); i
= 1 j1. x] (hcom 1 i B [] (coe 1 i (j1. B) x))))) {f.f (f.g (hcom i 0 B [] (coe
i 0 (l1. B) (hcom 1 0 B [1 = i i1. x; i = 0 j1. hcom 1 0 B [j1 = 0 i1. f.f (hcom
1 i1 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))); j1 = 1 i1. hcom 1 0 B []
(coe 1 0 (j2. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (j2. B) x)) {f.f (f.g (hcom
1 0 B [] (coe 1 0 (j2. B) x)))} {hcom 1 0 B [] (coe 1 0 (j2. B) x)} j1); i = 1
j1. x] (hcom 1 i B [] (coe 1 i (j1. B) x))))))} {hcom i 0 B [] (coe i 0 (l1. B)
(hcom 1 0 B [1 = i i1. x; i = 0 j1. hcom 1 0 B [j1 = 0 i1. f.f (hcom 1 i1 A []
(f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))); j1 = 1 i1. hcom 1 0 B [] (coe 1 0
(j2. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (j2. B) x)) {f.f (f.g (hcom 1 0 B []
(coe 1 0 (j2. B) x)))} {hcom 1 0 B [] (coe 1 0 (j2. B) x)} j1); i = 1 j1. x]
(hcom 1 i B [] (coe 1 i (j1. B) x))))} j); k1 = 1 j. hcom 1 0 B [j = 0 i1. hcom
1 i1 B [i = 1 i2. x] (hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [1 = i i2. x; i
= 0 j1. hcom 1 0 B [j1 = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j2. B) x)))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (j2. B) x)] (f.rinv (hcom 1 0 B
[] (coe 1 0 (j2. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))} {hcom 1
0 B [] (coe 1 0 (j2. B) x)} j1); i = 1 j1. x] (hcom 1 i B [] (coe 1 i (j1. B)
x))))); j = 1 i1. hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [1 = i i2. x; i = 0
j1. hcom 1 0 B [j1 = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j2. B) x)))); j1 = 1 i2. hcom 1 0 B [] (coe 1 0 (j2. B) x)] (f.rinv (hcom 1 0 B
[] (coe 1 0 (j2. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))} {hcom 1
0 B [] (coe 1 0 (j2. B) x)} j1); i = 1 j1. x] (hcom 1 i B [] (coe 1 i (j1. B)
x)))); i = 1 i1. x] (hcom i 1 B [] (coe i 1 (l1. B) (hcom 1 0 B [1 = i i1. x; i
= 0 j1. hcom 1 0 B [j1 = 0 i1. f.f (hcom 1 i1 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j2. B) x)))); j1 = 1 i1. hcom 1 0 B [] (coe 1 0 (j2. B) x)] (f.rinv (hcom 1 0 B
[] (coe 1 0 (j2. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (j2. B) x)))} {hcom 1
0 B [] (coe 1 0 (j2. B) x)} j1); i = 1 j1. x] (hcom 1 i B [] (coe 1 i (j1. B)
x)))))] (hcom i k1 B [] (coe i k1 (l1. B) (hcom 1 0 B [1 = i i1. x; i = 0
j. hcom 1 0 B [j = 0 i1. f.f (hcom 1 i1 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j1. B) x)))); j = 1 i1. hcom 1 0 B [] (coe 1 0 (j1. B) x)] (f.rinv (hcom 1 0 B
[] (coe 1 0 (j1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))} {hcom 1
0 B [] (coe 1 0 (j1. B) x)} j); i = 1 j. x] (hcom 1 i B [] (coe 1 i (j. B)
x)))))))); k = 1 k1. hcom 1 0 B [1 = i i1. x; i = 0 j. hcom 1 0 B [j = 0 i1. f.f
(hcom 1 i1 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))); j = 1 i1. hcom 1 0 B
[] (coe 1 0 (j1. B) x)] (f.rinv (hcom 1 0 B [] (coe 1 0 (j1. B) x)) {f.f (f.g
(hcom 1 0 B [] (coe 1 0 (j1. B) x)))} {hcom 1 0 B [] (coe 1 0 (j1. B) x)} j); i
= 1 j. x] (hcom 1 i B [] (coe 1 i (j. B) x)); i = 0 i1. f.f (hcom 0 i1 A [k = 0
k1. hcom 1 0 A [k1 = 0 i2. f.linv (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j. B) x)))) {hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))} {f.g (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))))} i2] (f.g (hcom k1 0 B
[] (coe k1 0 (l1. B) (hcom 1 0 B [0 = k1 i2. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B
[] (coe 1 0 (j. B) x)))); k1 = 0 j. f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe
1 0 (j1. B) x)))); k1 = 1 j. hcom 1 0 B [j = 0 i2. hcom 1 i2 B [] (hcom 0 1 B []
(coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B)
x))))))); j = 1 i2. hcom 0 1 B [] (coe 0 1 (l1. B) (f.f (hcom 1 0 A [] (f.g
(hcom 1 0 B [] (coe 1 0 (j1. B) x))))))] (hcom 0 1 B [] (coe 0 1 (l1. B) (f.f
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))))))] (hcom 0 k1 B []
(coe 0 k1 (l1. B) (f.f (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B)
x))))))))))); k = 1 k1. hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x)))]
(hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (j. B) x))))); i = 1 i1. hcom 1 i1 B
[k = 0 k1. hcom 1 0 B [k1 = 1 i2. x] (hcom k1 1 B [] (coe k1 1 (l1. B) (hcom 1 0
B [1 = k1 i2. x; k1 = 0 j. hcom 1 0 B [j = 0 i2. f.f (hcom 1 i2 A [] (f.g (hcom
1 0 B [] (coe 1 0 (l1. B) x)))); j = 1 i2. hcom 1 0 B [] (coe 1 0 (l1. B) x)]
(f.rinv (hcom 1 0 B [] (coe 1 0 (l1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0
(l1. B) x)))} {hcom 1 0 B [] (coe 1 0 (l1. B) x)} j); k1 = 1 j. x] (hcom 1 k1 B
[] (coe 1 k1 (l1. B) x))))); k = 1 k1. x] x] (hcom 1 0 B [1 = i i1. x; i = 0
j. hcom 1 0 B [j = 0 i1. f.f (hcom 1 i1 A [] (f.g (hcom 1 0 B [] (coe 1 0
(j1. B) x)))); j = 1 i1. hcom 1 0 B [] (coe 1 0 (j1. B) x)] (f.rinv (hcom 1 0 B
[] (coe 1 0 (j1. B) x)) {f.f (f.g (hcom 1 0 B [] (coe 1 0 (j1. B) x)))} {hcom 1
0 B [] (coe 1 0 (j1. B) x)} j); i = 1 j. x] (hcom 1 i B [] (coe 1 i (j. B)
x)))))))] (hcom 1 0 A [] (f.g (hcom 1 0 B [] (coe 1 0 (i. B) x)))));

uaTripNfOK' (A B : U)(f : equiv A B) : uaTrip' A B f = uaTripNf' A B f :=
  refl;
